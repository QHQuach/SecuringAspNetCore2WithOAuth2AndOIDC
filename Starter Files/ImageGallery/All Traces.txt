QQHQ :: LEGENDS:
    * Things happen behind the scene that we have control over (e.g. repository logic, our own middleware....)
    ** Things happen behind the scene that we DO NOT have control over (e.g. OpenID middleware over in identity service...)
    ... Action happens after a given point of time (e.g. user initiated mouse click)

THE ACTION FLOW (after the solution started)
    1. Login with Claire
    2. Consent
    3. Order Frame
    4. Home
    5. Edit Image
    6. Edit
    7. Logout

Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Information: User profile is available. Using 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
IdentityServer4.Startup:Information: Starting IdentityServer4 version 2.4.0.0
IdentityServer4.Startup:Information: You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
IdentityServer4.Startup:Information: Using the default authentication scheme idsrv for IdentityServer
IdentityServer4.Startup:Debug: Using idsrv as default ASP.NET Core scheme for authentication
IdentityServer4.Startup:Debug: Using idsrv as default ASP.NET Core scheme for sign-in
IdentityServer4.Startup:Debug: Using idsrv as default ASP.NET Core scheme for sign-out
IdentityServer4.Startup:Debug: Using idsrv as default ASP.NET Core scheme for challenge
IdentityServer4.Startup:Debug: Using idsrv as default ASP.NET Core scheme for forbid
Microsoft.EntityFrameworkCore.Infrastructure:Debug: An 'IServiceProvider' was created for internal use by Entity Framework.

QQHQ :: ...OIDC HOMEPAGE

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/
Microsoft.EntityFrameworkCore.Infrastructure:Information: Entity Framework Core 2.2.3-servicing-35854 initialized 'GalleryContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
IdentityServer4.Startup:Debug: Login Url: /Account/Login
IdentityServer4.Startup:Debug: Login Return Url Parameter: ReturnUrl
IdentityServer4.Startup:Debug: Logout Url: /Account/Logout
IdentityServer4.Startup:Debug: ConsentUrl Url: /consent
IdentityServer4.Startup:Debug: Consent Return Url Parameter: returnUrl
IdentityServer4.Startup:Debug: Error Url: /home/error
IdentityServer4.Startup:Debug: Error Id Parameter: errorId
Microsoft.EntityFrameworkCore.Migrations:Debug: Migrating using database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "Index", controller = "Home"}. Executing action IdentityServer4.Quickstart.UI.HomeController.Index (Marvin.IDP)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method IdentityServer4.Quickstart.UI.HomeController.Index (Marvin.IDP) - Validation state: Valid
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method IdentityServer4.Quickstart.UI.HomeController.Index (Marvin.IDP), returned result Microsoft.AspNetCore.Mvc.ViewResult in 1.0252ms.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executing ViewResult, running view Index.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Information: User profile is available. Using 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executed ViewResult - view Index executed in 204.6421ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action IdentityServer4.Quickstart.UI.HomeController.Index (Marvin.IDP) in 450.1207ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 798.4982ms 200 text/html; charset=utf-8
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (40ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (10ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (13ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
Microsoft.EntityFrameworkCore.Database.Command:Debug: A data reader was disposed.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Migrations:Information: No migrations were applied. The database is already up to date.

QQHQ :: ...*WEBAPP STARTUP REQUEST

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 DEBUG http://localhost:44393/  0
Microsoft.EntityFrameworkCore.Query:Debug: Compiling query model:
'from Image <generated>_0 in DbSet<Image>
select [<generated>_0]'
Microsoft.EntityFrameworkCore.Query:Debug: Optimized query model:
'from Image <generated>_0 in DbSet<Image>
select [<generated>_0]'
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 31.2629ms 200
Microsoft.EntityFrameworkCore.Query:Debug: (QueryContext queryContext) => IEnumerable<Image> _InterceptExceptions(
|__ source: IEnumerable<Image> _TrackEntities(
|   |__ results: IEnumerable<Image> _ShapedQuery(
|   |   |__ queryContext: queryContext,
|   |   |__ shaperCommandContext: SelectExpression:
|   |   |       SELECT [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
|   |   |       FROM [Images] AS [i],
|   |   |__ shaper: (MaterializationContext materializationContext) =>
|   |       {
|   |           instance = new Image()
|   |           instance.<Id>k__BackingField = Guid TryReadValue(ValueBuffer materializationContext.get_ValueBuffer(), 0, Image.Id)
|   |           instance.<FileName>k__BackingField = string TryReadValue(ValueBuffer materializationContext.get_ValueBuffer(), 1, Image.FileName)
|   |           instance.<OwnerId>k__BackingField = string TryReadValue(ValueBuffer materializationContext.get_ValueBuffer(), 2, Image.OwnerId)
|   |           instance.<Title>k__BackingField = string TryReadValue(ValueBuffer materializationContext.get_ValueBuffer(), 3, Image.Title)
|   |           return instance
|   |       }),
|   |__ queryContext: queryContext,
|   |__ entityTrackingInfos: { itemType: Image },
|   |__ entityAccessors: List<Func<Image, object>>
|       {
|           Func<Image, Image>,
|       }),
|__ contextType: ImageGallery.API.Entities.GalleryContext,
|__ logger: DiagnosticsLogger<Query>,
|__ queryContext: queryContext)
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
FROM [Images] AS [i]
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
FROM [Images] AS [i]
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Deleted'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.Database.Command:Debug: A data reader was disposed.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Update:Debug: SaveChanges starting for 'GalleryContext'.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: DetectChanges starting for 'GalleryContext'.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: DetectChanges completed for 'GalleryContext'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Transaction:Debug: Beginning transaction with isolation level 'ReadCommitted'.
Microsoft.EntityFrameworkCore.Update:Debug: Executing 14 update commands as a batch.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (DbType = Guid), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Guid)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [Images]
WHERE [Id] = @p0;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p2;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p3;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p4;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p5;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p6;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p7;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p8;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p10;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p11;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p12;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p13;
SELECT @@ROWCOUNT;
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (DbType = Guid), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (DbType = Guid)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [Images]
WHERE [Id] = @p0;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p2;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p3;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p4;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p5;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p6;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p7;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p8;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p9;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p10;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p11;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p12;
SELECT @@ROWCOUNT;

DELETE FROM [Images]
WHERE [Id] = @p13;
SELECT @@ROWCOUNT;
Microsoft.EntityFrameworkCore.Database.Command:Debug: A data reader was disposed.
Microsoft.EntityFrameworkCore.Database.Transaction:Debug: Committing transaction.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Transaction:Debug: Disposing transaction.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Deleted' to 'Detached'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.Update:Debug: SaveChanges completed for 'GalleryContext' with 14 entities written to the database.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.Update:Debug: SaveChanges starting for 'GalleryContext'.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: DetectChanges starting for 'GalleryContext'.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: DetectChanges completed for 'GalleryContext'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Transaction:Debug: Beginning transaction with isolation level 'ReadCommitted'.
Microsoft.EntityFrameworkCore.Update:Debug: Executing 14 update commands as a batch.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 200), @p2='?' (Size = 50), @p3='?' (Size = 150), @p4='?' (DbType = Guid), @p5='?' (Size = 200), @p6='?' (Size = 50), @p7='?' (Size = 150), @p8='?' (DbType = Guid), @p9='?' (Size = 200), @p10='?' (Size = 50), @p11='?' (Size = 150), @p12='?' (DbType = Guid), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (Size = 150), @p16='?' (DbType = Guid), @p17='?' (Size = 200), @p18='?' (Size = 50), @p19='?' (Size = 150), @p20='?' (DbType = Guid), @p21='?' (Size = 200), @p22='?' (Size = 50), @p23='?' (Size = 150), @p24='?' (DbType = Guid), @p25='?' (Size = 200), @p26='?' (Size = 50), @p27='?' (Size = 150), @p28='?' (DbType = Guid), @p29='?' (Size = 200), @p30='?' (Size = 50), @p31='?' (Size = 150), @p32='?' (DbType = Guid), @p33='?' (Size = 200), @p34='?' (Size = 50), @p35='?' (Size = 150), @p36='?' (DbType = Guid), @p37='?' (Size = 200), @p38='?' (Size = 50), @p39='?' (Size = 150), @p40='?' (DbType = Guid), @p41='?' (Size = 200), @p42='?' (Size = 50), @p43='?' (Size = 150), @p44='?' (DbType = Guid), @p45='?' (Size = 200), @p46='?' (Size = 50), @p47='?' (Size = 150), @p48='?' (DbType = Guid), @p49='?' (Size = 200), @p50='?' (Size = 50), @p51='?' (Size = 150), @p52='?' (DbType = Guid), @p53='?' (Size = 200), @p54='?' (Size = 50), @p55='?' (Size = 150)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Images] ([Id], [FileName], [OwnerId], [Title])
VALUES (@p0, @p1, @p2, @p3),
(@p4, @p5, @p6, @p7),
(@p8, @p9, @p10, @p11),
(@p12, @p13, @p14, @p15),
(@p16, @p17, @p18, @p19),
(@p20, @p21, @p22, @p23),
(@p24, @p25, @p26, @p27),
(@p28, @p29, @p30, @p31),
(@p32, @p33, @p34, @p35),
(@p36, @p37, @p38, @p39),
(@p40, @p41, @p42, @p43),
(@p44, @p45, @p46, @p47),
(@p48, @p49, @p50, @p51),
(@p52, @p53, @p54, @p55);
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 200), @p2='?' (Size = 50), @p3='?' (Size = 150), @p4='?' (DbType = Guid), @p5='?' (Size = 200), @p6='?' (Size = 50), @p7='?' (Size = 150), @p8='?' (DbType = Guid), @p9='?' (Size = 200), @p10='?' (Size = 50), @p11='?' (Size = 150), @p12='?' (DbType = Guid), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (Size = 150), @p16='?' (DbType = Guid), @p17='?' (Size = 200), @p18='?' (Size = 50), @p19='?' (Size = 150), @p20='?' (DbType = Guid), @p21='?' (Size = 200), @p22='?' (Size = 50), @p23='?' (Size = 150), @p24='?' (DbType = Guid), @p25='?' (Size = 200), @p26='?' (Size = 50), @p27='?' (Size = 150), @p28='?' (DbType = Guid), @p29='?' (Size = 200), @p30='?' (Size = 50), @p31='?' (Size = 150), @p32='?' (DbType = Guid), @p33='?' (Size = 200), @p34='?' (Size = 50), @p35='?' (Size = 150), @p36='?' (DbType = Guid), @p37='?' (Size = 200), @p38='?' (Size = 50), @p39='?' (Size = 150), @p40='?' (DbType = Guid), @p41='?' (Size = 200), @p42='?' (Size = 50), @p43='?' (Size = 150), @p44='?' (DbType = Guid), @p45='?' (Size = 200), @p46='?' (Size = 50), @p47='?' (Size = 150), @p48='?' (DbType = Guid), @p49='?' (Size = 200), @p50='?' (Size = 50), @p51='?' (Size = 150), @p52='?' (DbType = Guid), @p53='?' (Size = 200), @p54='?' (Size = 50), @p55='?' (Size = 150)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Images] ([Id], [FileName], [OwnerId], [Title])
VALUES (@p0, @p1, @p2, @p3),
(@p4, @p5, @p6, @p7),
(@p8, @p9, @p10, @p11),
(@p12, @p13, @p14, @p15),
(@p16, @p17, @p18, @p19),
(@p20, @p21, @p22, @p23),
(@p24, @p25, @p26, @p27),
(@p28, @p29, @p30, @p31),
(@p32, @p33, @p34, @p35),
(@p36, @p37, @p38, @p39),
(@p40, @p41, @p42, @p43),
(@p44, @p45, @p46, @p47),
(@p48, @p49, @p50, @p51),
(@p52, @p53, @p54, @p55);
Microsoft.EntityFrameworkCore.Database.Command:Debug: A data reader was disposed.
Microsoft.EntityFrameworkCore.Database.Transaction:Debug: Committing transaction.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Transaction:Debug: Disposing transaction.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Added' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.Update:Debug: SaveChanges completed for 'GalleryContext' with 14 entities written to the database.
Microsoft.EntityFrameworkCore.Infrastructure:Debug: 'GalleryContext' disposed.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Debug: Hosting starting
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Information: User profile is available. Using 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-04e99a5d-c117-479a-8e3f-54fbff3edf13.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-0ea3bf13-53e1-43fc-99d9-ff1ef04e73a5.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-28edfd9a-af8e-42eb-9756-9ae98ed4dd2d.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-3f5d254a-f8a1-4236-94c5-45626d5198cd.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-474f89fd-dffc-4eed-a3ac-9cf491362bce.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-57150470-f493-4f38-a1fa-62363424621f.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-5b9ec17e-c355-4fe7-a825-16125f402314.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-79d5e376-3a26-4152-95e0-08223be5e69d.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-857c8aef-bdf3-40d8-af31-ea1387e3dacd.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-9004e1d7-ca3a-4b41-8894-6e960ebcff3e.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-92280c87-7476-4c71-868e-e192826265ea.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-bb2a2178-4c0d-486d-8e7f-f67cb9a7b1cb.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-d9561bcc-9333-4bc7-8f34-b1f4c202f524.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-ed05c11a-e511-4812-8c3b-0c28fddd745f.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-f28da957-e3c8-4239-9c33-3f9b7e59db86.xml'.
Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository:Debug: Reading data from file 'C:\Users\Quang.Quach\AppData\Local\ASP.NET\DataProtection-Keys\key-f6cbe82e-78b1-46f8-ad19-074aef78a22b.xml'.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {04e99a5d-c117-479a-8e3f-54fbff3edf13}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {0ea3bf13-53e1-43fc-99d9-ff1ef04e73a5}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {28edfd9a-af8e-42eb-9756-9ae98ed4dd2d}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {3f5d254a-f8a1-4236-94c5-45626d5198cd}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {474f89fd-dffc-4eed-a3ac-9cf491362bce}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {57150470-f493-4f38-a1fa-62363424621f}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {5b9ec17e-c355-4fe7-a825-16125f402314}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {79d5e376-3a26-4152-95e0-08223be5e69d}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {857c8aef-bdf3-40d8-af31-ea1387e3dacd}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {9004e1d7-ca3a-4b41-8894-6e960ebcff3e}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {92280c87-7476-4c71-868e-e192826265ea}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {bb2a2178-4c0d-486d-8e7f-f67cb9a7b1cb}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {d9561bcc-9333-4bc7-8f34-b1f4c202f524}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {ed05c11a-e511-4812-8c3b-0c28fddd745f}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {f28da957-e3c8-4239-9c33-3f9b7e59db86}.
Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager:Debug: Found key {f6cbe82e-78b1-46f8-ad19-074aef78a22b}.
Microsoft.AspNetCore.DataProtection.KeyManagement.DefaultKeyResolver:Debug: Considering key {bb2a2178-4c0d-486d-8e7f-f67cb9a7b1cb} with expiration date 2019-08-15 16:00:23Z as default key.
Microsoft.AspNetCore.DataProtection.TypeForwardingActivator:Debug: Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=2.1.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor:Debug: Decrypting secret element using Windows DPAPI.
Microsoft.AspNetCore.DataProtection.TypeForwardingActivator:Debug: Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=2.1.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.CngCbcAuthenticatedEncryptorFactory:Debug: Opening CNG algorithm 'AES' from provider '(null)' with chaining mode CBC.
Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.CngCbcAuthenticatedEncryptorFactory:Debug: Opening CNG algorithm 'SHA256' from provider '(null)' with HMAC.
Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingProvider:Debug: Using key {bb2a2178-4c0d-486d-8e7f-f67cb9a7b1cb} as the default key.
Microsoft.AspNetCore.DataProtection.Internal.DataProtectionStartupFilter:Debug: Key ring with default key {bb2a2178-4c0d-486d-8e7f-f67cb9a7b1cb} was loaded during application startup.
Microsoft.AspNetCore.Mvc.MvcJsonOptions:Debug: Compatibility switch AllowInputFormatterExceptionMessages in type MvcJsonOptions is using default value False
Microsoft.AspNetCore.Mvc.MvcOptions:Debug: Compatibility switch AllowCombiningAuthorizeFilters in type MvcOptions is using default value False
Microsoft.AspNetCore.Mvc.MvcOptions:Debug: Compatibility switch AllowBindingHeaderValuesToNonStringModelTypes in type MvcOptions is using default value False
Microsoft.AspNetCore.Mvc.MvcOptions:Debug: Compatibility switch AllowValidatingTopLevelNodes in type MvcOptions is using default value False
Microsoft.AspNetCore.Mvc.MvcOptions:Debug: Compatibility switch InputFormatterExceptionPolicy in type MvcOptions is using default value AllExceptions
Microsoft.AspNetCore.Mvc.MvcOptions:Debug: Compatibility switch SuppressBindingUndefinedValueToEnumType in type MvcOptions is using default value False
Microsoft.AspNetCore.Mvc.MvcOptions:Debug: Compatibility switch EnableEndpointRouting in type MvcOptions is using default value False
Microsoft.AspNetCore.Mvc.MvcOptions:Debug: Compatibility switch MaxValidationDepth in type MvcOptions is using default value (null)
Microsoft.AspNetCore.Mvc.MvcOptions:Debug: Compatibility switch AllowShortCircuitingValidationWhenNoValidatorsArePresent in type MvcOptions is using default value False
Microsoft.AspNetCore.Mvc.ApiBehaviorOptions:Debug: Compatibility switch SuppressMapClientErrors in type ApiBehaviorOptions is using compatibility value True for version Version_2_0
Microsoft.AspNetCore.Mvc.ApiBehaviorOptions:Debug: Compatibility switch SuppressUseValidationProblemDetailsForInvalidModelStateResponses in type ApiBehaviorOptions is using compatibility value True for version Version_2_0
Microsoft.AspNetCore.Mvc.ApiBehaviorOptions:Debug: Compatibility switch AllowInferringBindingSourceForCollectionTypesAsFromQuery in type ApiBehaviorOptions is using compatibility value True for version Version_2_0
Microsoft.AspNetCore.Mvc.RazorPages.RazorPagesOptions:Debug: Compatibility switch AllowAreas in type RazorPagesOptions is using default value False
Microsoft.AspNetCore.Mvc.RazorPages.RazorPagesOptions:Debug: Compatibility switch AllowMappingHeadRequestsToGetHandler in type RazorPagesOptions is using default value False
Microsoft.AspNetCore.Mvc.RazorPages.RazorPagesOptions:Debug: Compatibility switch AllowDefaultHandlingForOptionsRequests in type RazorPagesOptions is using default value False
Microsoft.AspNetCore.Mvc.Razor.RazorViewEngineOptions:Debug: Compatibility switch AllowRecompilingViewsOnFileChange in type RazorViewEngineOptions is using explicitly configured value True
Microsoft.AspNetCore.Mvc.MvcViewOptions:Debug: Compatibility switch SuppressTempDataAttributePrefix in type MvcViewOptions is using default value False
Microsoft.AspNetCore.Mvc.MvcViewOptions:Debug: Compatibility switch AllowRenderingMaxLengthAttribute in type MvcViewOptions is using default value False
Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory:Debug: Registered model binder providers, in the following order: Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider, Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider
Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer:Debug: Failed to locate the development https certificate at '(null)'.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Debug: Hosting started
Microsoft.AspNetCore.Hosting.Internal.WebHost:Debug: Loaded hosting startup assembly ImageGallery.API
Microsoft.AspNetCore.Hosting.Internal.WebHost:Debug: Loaded hosting startup assembly Microsoft.AspNetCore.Server.IISIntegration
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G1" started.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 DEBUG http://localhost:44329/  0
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Debug: Wildcard detected, all requests with hosts will be allowed.
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Trace: All hosts are allowed.
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G1" completed keep alive response.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 59.5258ms 200

QQHQ :: STARTED...HOME PAGE :: http://localhost:44393/

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "Index", controller = "Gallery"}. Executing action ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client)
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization failed.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Authorization failed for the request at filter 'Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter'.
Microsoft.AspNetCore.Mvc.ChallengeResult:Information: Executing ChallengeResult with authentication schemes ().

QQHQ :: ...**GET OIDC DISCOVERY

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/.well-known/openid-configuration
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
IdentityServer4.Endpoints.DiscoveryEndpoint:Debug: Start discovery request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 121.9813ms 200 application/json; charset=UTF-8

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/.well-known/openid-configuration/jwks
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
IdentityServer4.Endpoints.DiscoveryKeyEndpoint:Debug: Start key discovery request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 28.0571ms 200 application/jwk-set+json; charset=UTF-8

Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler:Information: AuthenticationScheme: oidc was challenged.

QQHQ :: ...**EXECUTE OIDC CHALLENGE

Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client) in 578.698ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 826.4586ms 302

QQHQ :: ...**REDIRECT TO OIDC AUTHORIZATION ENDPOINT

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/connect/authorize?client_id=imagegalleryclient&redirect_uri=https%3A%2F%2Flocalhost%3A44393%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20address%20roles%20country%20subscriptionlevel%20imagegalleryapi%20offline_access&response_mode=form_post&nonce=636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl&state=CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/authorize matched to endpoint type Authorize
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
IdentityServer4.Endpoints.AuthorizeEndpoint:Debug: Start authorize request
IdentityServer4.Endpoints.AuthorizeEndpoint:Debug: No user present in authorize request
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Start authorize request protocol validation
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Checking for PKCE parameters
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: No PKCE used.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
IdentityServer4.Endpoints.AuthorizeEndpoint:Information: ValidatedAuthorizeRequest
{
  "ClientId": "imagegalleryclient",
  "ClientName": "Image Gallery",
  "RedirectUri": "https://localhost:44393/signin-oidc",
  "AllowedRedirectUris": [
    "https://localhost:44393/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address roles country subscriptionlevel imagegalleryapi offline_access",
  "State": "CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM",
  "Nonce": "636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl",
  "Raw": {
    "client_id": "imagegalleryclient",
    "redirect_uri": "https://localhost:44393/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address roles country subscriptionlevel imagegalleryapi offline_access",
    "response_mode": "form_post",
    "nonce": "636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl",
    "state": "CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM",
    "x-client-SKU": "ID_NETSTANDARD2_0",
    "x-client-ver": "5.3.0.0"
  }
}
IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator:Information: Showing login: User is not authenticated
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 122.6033ms 302

QQHQ :: OIDC :: ...*REQUEST LOGIN PAGE

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dimagegalleryclient%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A44393%252Fsignin-oidc%26response_type%3Dcode%2520id_token%26scope%3Dopenid%2520profile%2520address%2520roles%2520country%2520subscriptionlevel%2520imagegalleryapi%2520offline_access%26response_mode%3Dform_post%26nonce%3D636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl%26state%3DCfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D5.3.0.0
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "Login", controller = "Account"}. Executing action IdentityServer4.Quickstart.UI.AccountController.Login (Marvin.IDP)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method IdentityServer4.Quickstart.UI.AccountController.Login (Marvin.IDP) with arguments (/connect/authorize/callback?client_id=imagegalleryclient&redirect_uri=https%3A%2F%2Flocalhost%3A44393%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20address%20roles%20country%20subscriptionlevel%20imagegalleryapi%20offline_access&response_mode=form_post&nonce=636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl&state=CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0) - Validation state: Valid
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Start authorize request protocol validation
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Checking for PKCE parameters
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: No PKCE used.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method IdentityServer4.Quickstart.UI.AccountController.Login (Marvin.IDP), returned result Microsoft.AspNetCore.Mvc.ViewResult in 28.8561ms.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executing ViewResult, running view Login.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executed ViewResult - view Login executed in 108.0444ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action IdentityServer4.Quickstart.UI.AccountController.Login (Marvin.IDP) in 183.7041ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 207.7239ms 200 text/html; charset=utf-8


QQHQ ***********************************************************************************************************************************************
QQHQ :: OIDC :: LOGIN PAGE SHOWN...1.LOGIN


Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST https://localhost:44314/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dimagegalleryclient%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A44393%252Fsignin-oidc%26response_type%3Dcode%2520id_token%26scope%3Dopenid%2520profile%2520address%2520roles%2520country%2520subscriptionlevel%2520imagegalleryapi%2520offline_access%26response_mode%3Dform_post%26nonce%3D636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl%26state%3DCfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D5.3.0.0 application/x-www-form-urlencoded 1131
IdentityServer4.Hosting.CorsPolicyProvider:Debug: CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "Login", controller = "Account"}. Executing action IdentityServer4.Quickstart.UI.AccountController.Login (Marvin.IDP)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method IdentityServer4.Quickstart.UI.AccountController.Login (Marvin.IDP) with arguments (IdentityServer4.Quickstart.UI.LoginInputModel, login) - Validation state: Valid
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Start authorize request protocol validation
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Checking for PKCE parameters
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: No PKCE used.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
IdentityServer4.Hosting.IdentityServerAuthenticationService:Debug: Augmenting SignInContext
IdentityServer4.Hosting.IdentityServerAuthenticationService:Debug: Adding idp claim with value: local
IdentityServer4.Hosting.IdentityServerAuthenticationService:Debug: Adding amr claim with value: pwd
Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler:Information: AuthenticationScheme: idsrv signed in.
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method IdentityServer4.Quickstart.UI.AccountController.Login (Marvin.IDP), returned result Microsoft.AspNetCore.Mvc.RedirectResult in 48.0785ms.
Microsoft.AspNetCore.Mvc.Infrastructure.RedirectResultExecutor:Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=imagegalleryclient&redirect_uri=https%3A%2F%2Flocalhost%3A44393%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20address%20roles%20country%20subscriptionlevel%20imagegalleryapi%20offline_access&response_mode=form_post&nonce=636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl&state=CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action IdentityServer4.Quickstart.UI.AccountController.Login (Marvin.IDP) in 104.2783ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 124.9883ms 302

QQHQ :: OIDC :: ...*REDIRECT TO AUTHORIZATION ENDPOINT

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/connect/authorize/callback?client_id=imagegalleryclient&redirect_uri=https%3A%2F%2Flocalhost%3A44393%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20address%20roles%20country%20subscriptionlevel%20imagegalleryapi%20offline_access&response_mode=form_post&nonce=636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl&state=CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
IdentityServer4.Endpoints.AuthorizeCallbackEndpoint:Debug: Start authorize callback request
IdentityServer4.Endpoints.AuthorizeCallbackEndpoint:Debug: User in authorize request: b7539694-97e7-4dfe-84da-b4256e1ff5c7
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Start authorize request protocol validation
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Checking for PKCE parameters
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: No PKCE used.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
IdentityServer4.Endpoints.AuthorizeCallbackEndpoint:Information: ValidatedAuthorizeRequest
{
  "ClientId": "imagegalleryclient",
  "ClientName": "Image Gallery",
  "RedirectUri": "https://localhost:44393/signin-oidc",
  "AllowedRedirectUris": [
    "https://localhost:44393/signin-oidc"
  ],
  "SubjectId": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address roles country subscriptionlevel imagegalleryapi offline_access",
  "State": "CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM",
  "Nonce": "636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl",
  "SessionId": "70669c50271a289cb20a19cb44050aa5",
  "Raw": {
    "client_id": "imagegalleryclient",
    "redirect_uri": "https://localhost:44393/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address roles country subscriptionlevel imagegalleryapi offline_access",
    "response_mode": "form_post",
    "nonce": "636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl",
    "state": "CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM",
    "x-client-SKU": "ID_NETSTANDARD2_0",
    "x-client-ver": "5.3.0.0"
  }
}
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: AuthorizeEndpoint
IdentityServer4.Services.DefaultConsentService:Debug: Scopes contains offline_access, consent is required
IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator:Information: Showing consent: User has not yet consented
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 45.1233ms 302

QQHQ :: OIDC :: ...*REDIRECT TO CONSENT PAGE

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/consent?returnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dimagegalleryclient%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A44393%252Fsignin-oidc%26response_type%3Dcode%2520id_token%26scope%3Dopenid%2520profile%2520address%2520roles%2520country%2520subscriptionlevel%2520imagegalleryapi%2520offline_access%26response_mode%3Dform_post%26nonce%3D636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl%26state%3DCfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D5.3.0.0
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "Index", controller = "Consent"}. Executing action IdentityServer4.Quickstart.UI.ConsentController.Index (Marvin.IDP)
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method IdentityServer4.Quickstart.UI.ConsentController.Index (Marvin.IDP) with arguments (/connect/authorize/callback?client_id=imagegalleryclient&redirect_uri=https%3A%2F%2Flocalhost%3A44393%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20address%20roles%20country%20subscriptionlevel%20imagegalleryapi%20offline_access&response_mode=form_post&nonce=636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl&state=CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0) - Validation state: Valid
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Start authorize request protocol validation
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Checking for PKCE parameters
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: No PKCE used.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method IdentityServer4.Quickstart.UI.ConsentController.Index (Marvin.IDP), returned result Microsoft.AspNetCore.Mvc.ViewResult in 23.0325ms.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executing ViewResult, running view Index.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executed ViewResult - view Index executed in 87.0559ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action IdentityServer4.Quickstart.UI.ConsentController.Index (Marvin.IDP) in 154.4049ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 164.0155ms 200 text/html; charset=utf-8
Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets:Debug: Connection id "0HLN5Q2LN75G1" received FIN.
Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets:Debug: Connection id "0HLN5Q2LN75G1" sending FIN because: "The client closed the connection."
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G1" disconnecting.
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G1" stopped.

QQHQ ***********************************************************************************************************************************************
QQHQ :: OIDC :: CONSENT PAGE SHOWN...2.CONSENT

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST https://localhost:44314/consent application/x-www-form-urlencoded 1354
IdentityServer4.Hosting.CorsPolicyProvider:Debug: CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "Index", controller = "Consent"}. Executing action IdentityServer4.Quickstart.UI.ConsentController.Index (Marvin.IDP)
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method IdentityServer4.Quickstart.UI.ConsentController.Index (Marvin.IDP) with arguments (IdentityServer4.Quickstart.UI.ConsentInputModel) - Validation state: Valid
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Start authorize request protocol validation
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Checking for PKCE parameters
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: No PKCE used.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method IdentityServer4.Quickstart.UI.ConsentController.Index (Marvin.IDP), returned result Microsoft.AspNetCore.Mvc.RedirectResult in 31.8841ms.
Microsoft.AspNetCore.Mvc.Infrastructure.RedirectResultExecutor:Information: Executing RedirectResult, redirecting to /connect/authorize/callback?client_id=imagegalleryclient&redirect_uri=https%3A%2F%2Flocalhost%3A44393%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20address%20roles%20country%20subscriptionlevel%20imagegalleryapi%20offline_access&response_mode=form_post&nonce=636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl&state=CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action IdentityServer4.Quickstart.UI.ConsentController.Index (Marvin.IDP) in 83.65ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 107.3705ms 302

QQHQ :: OIDC :: ...*REDIRECT TO AUTHORIZATION ENDPOINT

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/connect/authorize/callback?client_id=imagegalleryclient&redirect_uri=https%3A%2F%2Flocalhost%3A44393%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20address%20roles%20country%20subscriptionlevel%20imagegalleryapi%20offline_access&response_mode=form_post&nonce=636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl&state=CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/authorize/callback matched to endpoint type Authorize
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
IdentityServer4.Endpoints.AuthorizeCallbackEndpoint:Debug: Start authorize callback request
IdentityServer4.Endpoints.AuthorizeCallbackEndpoint:Debug: User in authorize request: b7539694-97e7-4dfe-84da-b4256e1ff5c7
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Start authorize request protocol validation
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Checking for PKCE parameters
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: No PKCE used.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
IdentityServer4.Endpoints.AuthorizeCallbackEndpoint:Information: ValidatedAuthorizeRequest
{
  "ClientId": "imagegalleryclient",
  "ClientName": "Image Gallery",
  "RedirectUri": "https://localhost:44393/signin-oidc",
  "AllowedRedirectUris": [
    "https://localhost:44393/signin-oidc"
  ],
  "SubjectId": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address roles country subscriptionlevel imagegalleryapi offline_access",
  "State": "CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM",
  "Nonce": "636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl",
  "SessionId": "70669c50271a289cb20a19cb44050aa5",
  "Raw": {
    "client_id": "imagegalleryclient",
    "redirect_uri": "https://localhost:44393/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address roles country subscriptionlevel imagegalleryapi offline_access",
    "response_mode": "form_post",
    "nonce": "636949082061779720.MGYxOTA2YWItZWIyYS00NDI0LWJjZjYtN2Q1MTU1MzQzODY0ZTEwNTMzYmYtMTRiZC00ODRiLTlkOGMtNTA5M2E0OTdjMjdl",
    "state": "CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM",
    "x-client-SKU": "ID_NETSTANDARD2_0",
    "x-client-ver": "5.3.0.0"
  }
}
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: AuthorizeEndpoint
IdentityServer4.Services.DefaultConsentService:Debug: Scopes contains offline_access, consent is required
IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator:Information: User consented to scopes: openid, profile, address, roles, country, subscriptionlevel, imagegalleryapi, offline_access
IdentityServer4.Services.DefaultConsentService:Debug: Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: b7539694-97e7-4dfe-84da-b4256e1ff5c7
IdentityServer4.ResponseHandling.AuthorizeResponseGenerator:Debug: Creating Hybrid Flow response.
IdentityServer4.ResponseHandling.AuthorizeResponseGenerator:Debug: Creating Implicit Flow response.
IdentityServer4.Services.DefaultClaimsService:Debug: Getting claims for identity token for subject: b7539694-97e7-4dfe-84da-b4256e1ff5c7 and client: imagegalleryclient
IdentityServer4.Services.DefaultClaimsService:Debug: In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
IdentityServer4.Endpoints.AuthorizeCallbackEndpoint:Information: Authorize endpoint response
{
  "SubjectId": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
  "ClientId": "imagegalleryclient",
  "RedirectUri": "https://localhost:44393/signin-oidc",
  "State": "CfDJ8HghKrsNTG1Ijn_2fLmnscuTeRQPcT8pUw67mqcRB4CwvwhZIWfoqq8ZhrdhGlOAAJh1odBogAL4YsMuK3lAy0a3zv_-ZBueo9ZJRmwRR6C2AJp7N7CRGy2xMdLDNQz9vCJ2MOmCSO1GEtuaFPVa1oJdEy3-VyV_MkhOt2QGPZ7yrRDub3eN6xztxFI7nGlsnynnTqHzglZGnbUf78rHQD2Yse6EYmmdqGTFhupurXgHrq6EKb1M4flJpajapm2HNg0rBvjz-A1TY2sYIGwFv5p__ru7PoYr6idfZ-5tvMARCjEC8tsUU0PQTOyPjb1pDzXb8e2wCUmbFGzE1xQV4yM",
  "Scope": "openid profile address roles country subscriptionlevel imagegalleryapi offline_access"
}
IdentityServer4.Hosting.IdentityServerAuthenticationService:Debug: Augmenting SignInContext
Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler:Information: AuthenticationScheme: idsrv signed in.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 189.0888ms 200 text/html; charset=UTF-8

QQHQ ***********************************************************************************************************************************************
QQHQ :: OIDC :: ...*CALL BACK TO CLIENT OIDC SIGN IN URL

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST http://localhost:44393/signin-oidc application/x-www-form-urlencoded 1595

QQHQ :: ...**GET ID TOKEN

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST https://localhost:44314/connect/token application/x-www-form-urlencoded 221
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/token matched to endpoint type Token
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
IdentityServer4.Endpoints.TokenEndpoint:Debug: Start token request.
IdentityServer4.Validation.ClientSecretValidator:Debug: Start client validation
IdentityServer4.Validation.BasicAuthenticationSecretParser:Debug: Start parsing Basic Authentication secret
IdentityServer4.Validation.PostBodySecretParser:Debug: Start parsing for secret in post body
IdentityServer4.Validation.SecretParser:Debug: Parser found secret: PostBodySecretParser
IdentityServer4.Validation.SecretParser:Debug: Secret id found: imagegalleryclient
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.SecretValidator:Debug: Secret validator success: HashedSharedSecretValidator
IdentityServer4.Validation.ClientSecretValidator:Debug: Client validation success
IdentityServer4.Validation.TokenRequestValidator:Debug: Start token request validation
IdentityServer4.Validation.TokenRequestValidator:Debug: Start validation of authorization code token request
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: AuthorizationCodeValidation
IdentityServer4.Validation.TokenRequestValidator:Debug: Validation of authorization code token request success
IdentityServer4.Validation.TokenRequestValidator:Information: Token request validation success
{
  "ClientId": "imagegalleryclient",
  "ClientName": "Image Gallery",
  "GrantType": "authorization_code",
  "AuthorizationCode": "3c4db3dece3c749cc9cc23eed94cf9738182a38a9920bcc1aa2b6cefa5e76b13",
  "Raw": {
    "client_id": "imagegalleryclient",
    "client_secret": "***REDACTED***",
    "code": "3c4db3dece3c749cc9cc23eed94cf9738182a38a9920bcc1aa2b6cefa5e76b13",
    "grant_type": "authorization_code",
    "redirect_uri": "https://localhost:44393/signin-oidc"
  }
}
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Services.DefaultClaimsService:Debug: Getting claims for access token for client: imagegalleryclient
IdentityServer4.Services.DefaultClaimsService:Debug: Getting claims for access token for subject: b7539694-97e7-4dfe-84da-b4256e1ff5c7
IdentityServer4.Test.TestUserProfileService:Debug: Get profile called for subject b7539694-97e7-4dfe-84da-b4256e1ff5c7 from client Image Gallery with claim types role via ClaimsProviderAccessToken
IdentityServer4.Test.TestUserProfileService:Debug: Issued claims: role
IdentityServer4.Services.DefaultRefreshTokenService:Debug: Creating refresh token
IdentityServer4.Services.DefaultRefreshTokenService:Debug: Setting an absolute lifetime: 2592000
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Services.DefaultClaimsService:Debug: Getting claims for identity token for subject: b7539694-97e7-4dfe-84da-b4256e1ff5c7 and client: imagegalleryclient
IdentityServer4.Services.DefaultClaimsService:Debug: In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
IdentityServer4.Endpoints.TokenEndpoint:Debug: Token request success.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 165.4472ms 200 application/json; charset=UTF-8

QQHQ :: ...**GET USER INFO

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/connect/userinfo
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/userinfo matched to endpoint type Userinfo
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
IdentityServer4.Endpoints.UserInfoEndpoint:Debug: Start userinfo request
IdentityServer4.Validation.BearerTokenUsageValidator:Debug: Bearer token found in header
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: AccessTokenValidation
IdentityServer4.Validation.TokenValidator:Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
IdentityServer4.Validation.TokenValidator:Debug: Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "ExpectedScope": "openid",
  "TokenHandle": "013231b5fac2320a906aafb294fe6e2791ddbb98ae9b8823626e69917b3145ff",
  "Claims": {
    "iss": "https://localhost:44314",
    "nbf": 1559311473,
    "exp": 1559311593,
    "aud": [
      "https://localhost:44314/resources",
      "imagegalleryapi"
    ],
    "client_id": "imagegalleryclient",
    "scope": [
      "openid",
      "profile",
      "address",
      "roles",
      "country",
      "subscriptionlevel",
      "imagegalleryapi",
      "offline_access"
    ],
    "sub": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
    "auth_time": 1559311430,
    "idp": "local",
    "amr": "pwd",
    "role": "PayingUser"
  }
}
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: UserInfoRequestValidation
IdentityServer4.ResponseHandling.UserInfoResponseGenerator:Debug: Creating userinfo response
IdentityServer4.ResponseHandling.UserInfoResponseGenerator:Debug: Scopes in access token: openid profile address roles country subscriptionlevel imagegalleryapi offline_access
IdentityServer4.ResponseHandling.UserInfoResponseGenerator:Debug: Scopes in access token: openid profile address roles country subscriptionlevel imagegalleryapi offline_access
IdentityServer4.ResponseHandling.UserInfoResponseGenerator:Debug: Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at address role country subscriptionlevel
IdentityServer4.ResponseHandling.UserInfoResponseGenerator:Debug: Scopes in access token: openid profile address roles country subscriptionlevel imagegalleryapi offline_access
IdentityServer4.Test.TestUserProfileService:Debug: Get profile called for subject b7539694-97e7-4dfe-84da-b4256e1ff5c7 from client Image Gallery with claim types sub, name, family_name, given_name, middle_name, nickname, preferred_username, profile, picture, website, gender, birthdate, zoneinfo, locale, updated_at, address, role, country, subscriptionlevel via UserInfoEndpoint
IdentityServer4.Test.TestUserProfileService:Debug: Issued claims: given_name, family_name, address, role, country, subscriptionlevel
IdentityServer4.ResponseHandling.UserInfoResponseGenerator:Information: Profile service returned the following claim types: given_name family_name address role country subscriptionlevel
IdentityServer4.Endpoints.UserInfoEndpoint:Debug: End userinfo request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 91.4286ms 200 application/json; charset=UTF-8
Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler:Information: AuthenticationScheme: Cookies signed in.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 415.1138ms 302

QQHQ :: ...**REDIRECT BACK TO HOME :: http://localhost:44393/

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "Index", controller = "Gallery"}. Executing action ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client)
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client) - Validation state: Valid
QQHQ :: EXTRACT ID TOKEN
================================ OIDC IDENTITY TOKEN INFO ======================================
Identity token: eyJhbGciOiJSUzI1NiIsImtpZCI6IjAzOGRiNTljYmM4ZDAxOWI1MjQ1YzNhODIzYWM5MTg3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTkzMTE0NzMsImV4cCI6MTU1OTMxMTc3MywiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NDQzMTQiLCJhdWQiOiJpbWFnZWdhbGxlcnljbGllbnQiLCJub25jZSI6IjYzNjk0OTA4MjA2MTc3OTcyMC5NR1l4T1RBMllXSXRaV0l5WVMwME5ESTBMV0pqWmpZdE4yUTFNVFUxTXpRek9EWTBaVEV3TlRNelltWXRNVFJpWkMwME9EUmlMVGxrT0dNdE5UQTVNMkUwT1Rkak1qZGwiLCJpYXQiOjE1NTkzMTE0NzMsImF0X2hhc2giOiJQZ1VOOV9WLTFma1BlaTBPYzIxLXZ3Iiwic2lkIjoiNzA2NjljNTAyNzFhMjg5Y2IyMGExOWNiNDQwNTBhYTUiLCJzdWIiOiJiNzUzOTY5NC05N2U3LTRkZmUtODRkYS1iNDI1NmUxZmY1YzciLCJhdXRoX3RpbWUiOjE1NTkzMTE0MzAsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.xKoYdXNdRSYeTIhewNfYU0N-MzGE9gvhS3LPXDyGHDUXXSdiRsROn5qjJ9N7g6wkA0eTPxrXIKBe00zEEqA9QQxvNbW7xlZiZ9s_-PWiLIwKViuJbuBHYyPCicsmBlD9a_PKxh89AusjbW3hQka5UgCu17C8qNKcw6mv_2kEqwudHd0LOxp4zPaE6wsw4cm0u-dnbAE3zkJf_EPwBnMgL-ouSOKjPH7XYg9fCjnLnY54aWX_H7TDiPgFArTOsrllskNYr_X4sWP-rPHKlWdAzDh9GBMK4vAgJxMthj0jssLvjDAkK1l2MDp-nOLtdFCtF7-OuorDDcPe_ZV8OgI0iA
Claim type: sub - Claim value: b7539694-97e7-4dfe-84da-b4256e1ff5c7
Claim type: amr - Claim value: pwd
Claim type: given_name - Claim value: Claire
Claim type: family_name - Claim value: Underwood
Claim type: role - Claim value: PayingUser
Claim type: country - Claim value: be
Claim type: subscriptionlevel - Claim value: PayingUser
================================ OIDC IDENTITY TOKEN INFO ======================================

QQHQ ***********************************************************************************************************************************************
QQHQ :: ...*CALLING API

QQHQ :: EXTRACT ACCESS TOKEN EXPIRATION
QQHQ :: EXTRACT ACCESS TOKEN
QQHQ :: SET BEARER ACCESS TOKEN...CALLING API

Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G2" started.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44329/api/images
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Trace: All hosts are allowed.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Debug: The request path /api/images does not match a supported file type
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: HandleAuthenticateAsync called
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: Token found: 013231b5fac2320a906aafb294fe6e2791ddbb98ae9b8823626e69917b3145ff
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: Token is a reference token and is supported.

QQHQ :: API :: ...**VALIDATE ACCESS TOKEN

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/.well-known/openid-configuration
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
IdentityServer4.Endpoints.DiscoveryEndpoint:Debug: Start discovery request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 11.8323ms 200 application/json; charset=UTF-8

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/.well-known/openid-configuration/jwks
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
IdentityServer4.Endpoints.DiscoveryKeyEndpoint:Debug: Start key discovery request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 10.6658ms 200 application/jwk-set+json; charset=UTF-8

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST https://localhost:44314/connect/introspect application/x-www-form-urlencoded 156
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/introspect matched to endpoint type Introspection
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
IdentityServer4.Endpoints.IntrospectionEndpoint:Debug: Starting introspection request.
IdentityServer4.Validation.BasicAuthenticationSecretParser:Debug: Start parsing Basic Authentication secret
IdentityServer4.Validation.PostBodySecretParser:Debug: Start parsing for secret in post body
IdentityServer4.Validation.SecretParser:Debug: Parser found secret: PostBodySecretParser
IdentityServer4.Validation.SecretParser:Debug: Secret id found: imagegalleryapi
IdentityServer4.Validation.SecretValidator:Debug: Secret validator success: HashedSharedSecretValidator
IdentityServer4.Validation.ApiSecretValidator:Debug: API resource validation success
IdentityServer4.Validation.IntrospectionRequestValidator:Debug: Introspection request validation started.
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: AccessTokenValidation
IdentityServer4.Validation.TokenValidator:Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
IdentityServer4.Validation.TokenValidator:Debug: Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "013231b5fac2320a906aafb294fe6e2791ddbb98ae9b8823626e69917b3145ff",
  "Claims": {
    "iss": "https://localhost:44314",
    "nbf": 1559311473,
    "exp": 1559311593,
    "aud": [
      "https://localhost:44314/resources",
      "imagegalleryapi"
    ],
    "client_id": "imagegalleryclient",
    "scope": [
      "openid",
      "profile",
      "address",
      "roles",
      "country",
      "subscriptionlevel",
      "imagegalleryapi",
      "offline_access"
    ],
    "sub": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
    "auth_time": 1559311430,
    "idp": "local",
    "amr": "pwd",
    "role": "PayingUser"
  }
}
IdentityServer4.Validation.IntrospectionRequestValidator:Debug: Introspection request validation successful.
IdentityServer4.ResponseHandling.IntrospectionResponseGenerator:Debug: Creating introspection response for active token.
IdentityServer4.Endpoints.IntrospectionEndpoint:Information: Success token introspection. Token active: True, for API name: imagegalleryapi
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 63.4012ms 200 application/json; charset=UTF-8
IdentityModel.AspNetCore.OAuth2Introspection.OAuth2IntrospectionHandler:Debug: AuthenticationScheme: BearerIdentityServerAuthenticationIntrospection was successfully authenticated.
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Debug: AuthenticationScheme: Bearer was successfully authenticated.

QQHQ :: API :: ...EXECUTE API

Microsoft.AspNetCore.Routing.Tree.TreeRouter:Debug: Request successfully matched the route with name '(null)' and template 'api/images'
Microsoft.AspNetCore.Mvc.Internal.ActionSelector:Debug: Action 'ImageGallery.API.Controllers.ImagesController.CreateImage (ImageGallery.API)' with id '763a4689-3a85-4433-a233-a44ca510cb2b' did not match the constraint 'Microsoft.AspNetCore.Mvc.Internal.HttpMethodActionConstraint'
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "GetImages", controller = "Images"}. Executing action ImageGallery.API.Controllers.ImagesController.GetImages (ImageGallery.API)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of authorization filters (in the following order): Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of resource filters (in the following order): Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of action filters (in the following order): Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter (Order: -2147483648), Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of exception filters (in the following order): None
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of result filters (in the following order): Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: Before executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: After executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: Before executing OnResourceExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: After executing OnResourceExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecutionAsync on filter Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecuting on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecuting on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method ImageGallery.API.Controllers.ImagesController.GetImages (ImageGallery.API) - Validation state: Valid
Microsoft.EntityFrameworkCore.Infrastructure:Information: Entity Framework Core 2.2.3-servicing-35854 initialized 'GalleryContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
Microsoft.EntityFrameworkCore.Query:Debug: Compiling query model:
'from Image i in DbSet<Image>
where [i].OwnerId == __ownerId_0
order by [i].Title asc
select [i]'
Microsoft.EntityFrameworkCore.Query:Debug: Optimized query model:
'from Image i in DbSet<Image>
where [i].OwnerId == __ownerId_0
order by [i].Title asc
select [i]'
Microsoft.EntityFrameworkCore.Query:Debug: (QueryContext queryContext) => IEnumerable<Image> _InterceptExceptions(
|__ source: IEnumerable<Image> _TrackEntities(
|   |__ results: IEnumerable<Image> _ShapedQuery(
|   |   |__ queryContext: queryContext,
|   |   |__ shaperCommandContext: SelectExpression:
|   |   |       SELECT [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
|   |   |       FROM [Images] AS [i]
|   |   |       WHERE [i].[OwnerId] = @__ownerId_0
|   |   |       ORDER BY [i].[Title],
|   |   |__ shaper: (MaterializationContext materializationContext) =>
|   |       {
|   |           instance = new Image()
|   |           instance.<Id>k__BackingField = Guid TryReadValue(ValueBuffer materializationContext.get_ValueBuffer(), 0, Image.Id)
|   |           instance.<FileName>k__BackingField = string TryReadValue(ValueBuffer materializationContext.get_ValueBuffer(), 1, Image.FileName)
|   |           instance.<OwnerId>k__BackingField = string TryReadValue(ValueBuffer materializationContext.get_ValueBuffer(), 2, Image.OwnerId)
|   |           instance.<Title>k__BackingField = string TryReadValue(ValueBuffer materializationContext.get_ValueBuffer(), 3, Image.Title)
|   |           return instance
|   |       }),
|   |__ queryContext: queryContext,
|   |__ entityTrackingInfos: { itemType: Image },
|   |__ entityAccessors: List<Func<Image, object>>
|       {
|           Func<Image, Image>,
|       }),
|__ contextType: ImageGallery.API.Entities.GalleryContext,
|__ logger: DiagnosticsLogger<Query>,
|__ queryContext: queryContext)
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[@__ownerId_0='?' (Size = 50)], CommandType='Text', CommandTimeout='30']
SELECT [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
FROM [Images] AS [i]
WHERE [i].[OwnerId] = @__ownerId_0
ORDER BY [i].[Title]
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (11ms) [Parameters=[@__ownerId_0='?' (Size = 50)], CommandType='Text', CommandTimeout='30']
SELECT [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
FROM [Images] AS [i]
WHERE [i].[OwnerId] = @__ownerId_0
ORDER BY [i].[Title]
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.Database.Command:Debug: A data reader was disposed.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method ImageGallery.API.Controllers.ImagesController.GetImages (ImageGallery.API), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 164.7048ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecuted on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecuted on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecutionAsync on filter Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: Before executing OnResultExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: After executing OnResultExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Before executing action result Microsoft.AspNetCore.Mvc.OkObjectResult.
Microsoft.AspNetCore.Mvc.Infrastructure.DefaultOutputFormatterSelector:Debug: List of registered output formatters, in the following order: Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter, Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter, Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter, Microsoft.AspNetCore.Mvc.Formatters.JsonOutputFormatter
Microsoft.AspNetCore.Mvc.Infrastructure.DefaultOutputFormatterSelector:Debug: Attempting to select an output formatter based on Accept header 'application/json'.
Microsoft.AspNetCore.Mvc.Infrastructure.DefaultOutputFormatterSelector:Debug: Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.JsonOutputFormatter' and content type 'application/json' to write the response.
Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor:Information: Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[ImageGallery.Model.Image, ImageGallery.Model, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: After executing action result Microsoft.AspNetCore.Mvc.OkObjectResult.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: Before executing OnResultExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: After executing OnResultExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: Before executing OnResourceExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: After executing OnResourceExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.API.Controllers.ImagesController.GetImages (ImageGallery.API) in 257.9244ms
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G2" completed keep alive response.
Microsoft.EntityFrameworkCore.Infrastructure:Debug: 'GalleryContext' disposed.

QQHQ :: ...RENDERING HOME PAGE

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 1000.4475ms 200 application/json; charset=utf-8
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client), returned result Microsoft.AspNetCore.Mvc.ViewResult in 1072.1431ms.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executing ViewResult, running view Index.
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executed ViewResult - view Index executed in 167.199ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client) in 1277.197ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 1290.0216ms 200 text/html; charset=utf-8
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/lib/bootstrap/dist/css/bootstrap.css
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/css/site.css
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/lib/jquery/dist/jquery.js
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G3" started.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Information: The file /lib/jquery/dist/jquery.js was not modified
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44329/images/dc3f39bf-d1da-465d-9ea4-935902c2e3d2.jpg
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44329/images/8d351bbb-f760-4b56-9d4e-e8d61619bf70.jpg
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Information: The file /css/site.css was not modified
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Trace: All hosts are allowed.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Information: The file /lib/bootstrap/dist/css/bootstrap.css was not modified
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Trace: All hosts are allowed.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 22.0233ms 304 application/javascript
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Trace: Range header's value is empty.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 35.3904ms 304 text/css
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Trace: Range header's value is empty.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 65.6609ms 304 text/css
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Information: The file /images/dc3f39bf-d1da-465d-9ea4-935902c2e3d2.jpg was not modified
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/lib/bootstrap/dist/js/bootstrap.js
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Information: The file /images/8d351bbb-f760-4b56-9d4e-e8d61619bf70.jpg was not modified
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/js/site.js?v=EWaMeWsJBYWmL2g_KkgXZQ5nPe-a3Ichp0LEgzXczKo
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G4" started.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Debug: Handled. Status code: 304 File: /images/8d351bbb-f760-4b56-9d4e-e8d61619bf70.jpg
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Information: The file /lib/bootstrap/dist/js/bootstrap.js was not modified
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Debug: Handled. Status code: 304 File: /images/dc3f39bf-d1da-465d-9ea4-935902c2e3d2.jpg
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 26.0783ms 304 application/javascript
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G2" completed keep alive response.
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G3" completed keep alive response.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Information: The file /js/site.js was not modified
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44329/images/cd139111-c82e-4bc8-9f7d-43a1059bfe73.jpg
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 34.7387ms 304 application/javascript
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 67.8697ms 304 image/jpeg
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Trace: All hosts are allowed.
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G5" started.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 63.5331ms 304 image/jpeg
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Trace: Range header's value is empty.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44329/images/e0e32179-109c-4a8a-bf91-3d65ff83ca29.jpg
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Information: The file /images/cd139111-c82e-4bc8-9f7d-43a1059bfe73.jpg was not modified
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Trace: All hosts are allowed.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Debug: Handled. Status code: 304 File: /images/cd139111-c82e-4bc8-9f7d-43a1059bfe73.jpg
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G6" started.
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G4" completed keep alive response.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Trace: Range header's value is empty.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 57.0699ms 304 image/jpeg
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Information: The file /images/e0e32179-109c-4a8a-bf91-3d65ff83ca29.jpg was not modified
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44329/images/cc412f08-2a7b-4225-b659-07fdb168302d.jpg
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Debug: Handled. Status code: 304 File: /images/e0e32179-109c-4a8a-bf91-3d65ff83ca29.jpg
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Trace: All hosts are allowed.
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G7" started.
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G2" completed keep alive response.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Trace: Range header's value is empty.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 45.6661ms 304 image/jpeg
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Information: The file /images/cc412f08-2a7b-4225-b659-07fdb168302d.jpg was not modified
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44329/images/fdfe7329-e05c-41fb-a7c7-4f3226d28c49.jpg
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Debug: Handled. Status code: 304 File: /images/cc412f08-2a7b-4225-b659-07fdb168302d.jpg
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Trace: All hosts are allowed.
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G6" completed keep alive response.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Trace: Range header's value is empty.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 41.2582ms 304 image/jpeg
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44329/images/b2894002-0b7c-4f05-896a-856283012c87.jpg
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Information: The file /images/fdfe7329-e05c-41fb-a7c7-4f3226d28c49.jpg was not modified
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Trace: All hosts are allowed.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Debug: Handled. Status code: 304 File: /images/fdfe7329-e05c-41fb-a7c7-4f3226d28c49.jpg
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Trace: Range header's value is empty.
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G7" completed keep alive response.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Information: The file /images/b2894002-0b7c-4f05-896a-856283012c87.jpg was not modified
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 47.269ms 304 image/jpeg
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Debug: Handled. Status code: 304 File: /images/b2894002-0b7c-4f05-896a-856283012c87.jpg
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G5" completed keep alive response.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 112.3218ms 304 image/jpeg


QQHQ ***********************************************************************************************************************************************
QQHQ :: HOME PAGE SHOWN...3.ORDER FRAME


Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/Gallery/OrderFrame
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "OrderFrame", controller = "Gallery"}. Executing action ImageGallery.Client.Controllers.GalleryController.OrderFrame (ImageGallery.Client)
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method ImageGallery.Client.Controllers.GalleryController.OrderFrame (ImageGallery.Client) - Validation state: Valid
QQHQ :: EXTRACT ID TOKEN
================================ OIDC IDENTITY TOKEN INFO ======================================
Identity token: eyJhbGciOiJSUzI1NiIsImtpZCI6IjAzOGRiNTljYmM4ZDAxOWI1MjQ1YzNhODIzYWM5MTg3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTkzMTE0NzMsImV4cCI6MTU1OTMxMTc3MywiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NDQzMTQiLCJhdWQiOiJpbWFnZWdhbGxlcnljbGllbnQiLCJub25jZSI6IjYzNjk0OTA4MjA2MTc3OTcyMC5NR1l4T1RBMllXSXRaV0l5WVMwME5ESTBMV0pqWmpZdE4yUTFNVFUxTXpRek9EWTBaVEV3TlRNelltWXRNVFJpWkMwME9EUmlMVGxrT0dNdE5UQTVNMkUwT1Rkak1qZGwiLCJpYXQiOjE1NTkzMTE0NzMsImF0X2hhc2giOiJQZ1VOOV9WLTFma1BlaTBPYzIxLXZ3Iiwic2lkIjoiNzA2NjljNTAyNzFhMjg5Y2IyMGExOWNiNDQwNTBhYTUiLCJzdWIiOiJiNzUzOTY5NC05N2U3LTRkZmUtODRkYS1iNDI1NmUxZmY1YzciLCJhdXRoX3RpbWUiOjE1NTkzMTE0MzAsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.xKoYdXNdRSYeTIhewNfYU0N-MzGE9gvhS3LPXDyGHDUXXSdiRsROn5qjJ9N7g6wkA0eTPxrXIKBe00zEEqA9QQxvNbW7xlZiZ9s_-PWiLIwKViuJbuBHYyPCicsmBlD9a_PKxh89AusjbW3hQka5UgCu17C8qNKcw6mv_2kEqwudHd0LOxp4zPaE6wsw4cm0u-dnbAE3zkJf_EPwBnMgL-ouSOKjPH7XYg9fCjnLnY54aWX_H7TDiPgFArTOsrllskNYr_X4sWP-rPHKlWdAzDh9GBMK4vAgJxMthj0jssLvjDAkK1l2MDp-nOLtdFCtF7-OuorDDcPe_ZV8OgI0iA
Claim type: sub - Claim value: b7539694-97e7-4dfe-84da-b4256e1ff5c7
Claim type: amr - Claim value: pwd
Claim type: given_name - Claim value: Claire
Claim type: family_name - Claim value: Underwood
Claim type: role - Claim value: PayingUser
Claim type: country - Claim value: be
Claim type: subscriptionlevel - Claim value: PayingUser
================================ OIDC IDENTITY TOKEN INFO ======================================

QQHQ :: ...*GET OIDC DISCOVERY

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/.well-known/openid-configuration
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
IdentityServer4.Endpoints.DiscoveryEndpoint:Debug: Start discovery request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 9.2471ms 200 application/json; charset=UTF-8
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/.well-known/openid-configuration/jwks
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
IdentityServer4.Endpoints.DiscoveryKeyEndpoint:Debug: Start key discovery request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 19.3214ms 200 application/jwk-set+json; charset=UTF-8

QQHQ :: EXTRACT ACCESS TOKEN

QQHQ :: ...*GET USER INFO

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/connect/userinfo
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/userinfo matched to endpoint type Userinfo
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
IdentityServer4.Endpoints.UserInfoEndpoint:Debug: Start userinfo request
IdentityServer4.Validation.BearerTokenUsageValidator:Debug: Bearer token found in header
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: AccessTokenValidation
IdentityServer4.Validation.TokenValidator:Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
IdentityServer4.Validation.TokenValidator:Debug: Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "ExpectedScope": "openid",
  "TokenHandle": "013231b5fac2320a906aafb294fe6e2791ddbb98ae9b8823626e69917b3145ff",
  "Claims": {
    "iss": "https://localhost:44314",
    "nbf": 1559311473,
    "exp": 1559311593,
    "aud": [
      "https://localhost:44314/resources",
      "imagegalleryapi"
    ],
    "client_id": "imagegalleryclient",
    "scope": [
      "openid",
      "profile",
      "address",
      "roles",
      "country",
      "subscriptionlevel",
      "imagegalleryapi",
      "offline_access"
    ],
    "sub": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
    "auth_time": 1559311430,
    "idp": "local",
    "amr": "pwd",
    "role": "PayingUser"
  }
}
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: UserInfoRequestValidation
IdentityServer4.ResponseHandling.UserInfoResponseGenerator:Debug: Creating userinfo response
IdentityServer4.ResponseHandling.UserInfoResponseGenerator:Debug: Scopes in access token: openid profile address roles country subscriptionlevel imagegalleryapi offline_access
IdentityServer4.ResponseHandling.UserInfoResponseGenerator:Debug: Scopes in access token: openid profile address roles country subscriptionlevel imagegalleryapi offline_access
IdentityServer4.ResponseHandling.UserInfoResponseGenerator:Debug: Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at address role country subscriptionlevel
IdentityServer4.ResponseHandling.UserInfoResponseGenerator:Debug: Scopes in access token: openid profile address roles country subscriptionlevel imagegalleryapi offline_access
IdentityServer4.Test.TestUserProfileService:Debug: Get profile called for subject b7539694-97e7-4dfe-84da-b4256e1ff5c7 from client Image Gallery with claim types sub, name, family_name, given_name, middle_name, nickname, preferred_username, profile, picture, website, gender, birthdate, zoneinfo, locale, updated_at, address, role, country, subscriptionlevel via UserInfoEndpoint
IdentityServer4.Test.TestUserProfileService:Debug: Issued claims: given_name, family_name, address, role, country, subscriptionlevel
IdentityServer4.ResponseHandling.UserInfoResponseGenerator:Information: Profile service returned the following claim types: given_name family_name address role country subscriptionlevel
IdentityServer4.Endpoints.UserInfoEndpoint:Debug: End userinfo request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 42.4768ms 200 application/json; charset=UTF-8
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method ImageGallery.Client.Controllers.GalleryController.OrderFrame (ImageGallery.Client), returned result Microsoft.AspNetCore.Mvc.ViewResult in 165.0548ms.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executing ViewResult, running view OrderFrame.
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executed ViewResult - view OrderFrame executed in 27.2733ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.Client.Controllers.GalleryController.OrderFrame (ImageGallery.Client) in 214.0824ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 223.1786ms 200 text/html; charset=utf-8


QQHQ ***********************************************************************************************************************************************
QQHQ :: ORDER FRAME PAGE SHOWN...4.HOME


Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "Index", controller = "Gallery"}. Executing action ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client)
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client) - Validation state: Valid
QQHQ :: EXTRACT ID TOKEN
================================ OIDC IDENTITY TOKEN INFO ======================================
Identity token: eyJhbGciOiJSUzI1NiIsImtpZCI6IjAzOGRiNTljYmM4ZDAxOWI1MjQ1YzNhODIzYWM5MTg3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTkzMTE0NzMsImV4cCI6MTU1OTMxMTc3MywiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NDQzMTQiLCJhdWQiOiJpbWFnZWdhbGxlcnljbGllbnQiLCJub25jZSI6IjYzNjk0OTA4MjA2MTc3OTcyMC5NR1l4T1RBMllXSXRaV0l5WVMwME5ESTBMV0pqWmpZdE4yUTFNVFUxTXpRek9EWTBaVEV3TlRNelltWXRNVFJpWkMwME9EUmlMVGxrT0dNdE5UQTVNMkUwT1Rkak1qZGwiLCJpYXQiOjE1NTkzMTE0NzMsImF0X2hhc2giOiJQZ1VOOV9WLTFma1BlaTBPYzIxLXZ3Iiwic2lkIjoiNzA2NjljNTAyNzFhMjg5Y2IyMGExOWNiNDQwNTBhYTUiLCJzdWIiOiJiNzUzOTY5NC05N2U3LTRkZmUtODRkYS1iNDI1NmUxZmY1YzciLCJhdXRoX3RpbWUiOjE1NTkzMTE0MzAsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.xKoYdXNdRSYeTIhewNfYU0N-MzGE9gvhS3LPXDyGHDUXXSdiRsROn5qjJ9N7g6wkA0eTPxrXIKBe00zEEqA9QQxvNbW7xlZiZ9s_-PWiLIwKViuJbuBHYyPCicsmBlD9a_PKxh89AusjbW3hQka5UgCu17C8qNKcw6mv_2kEqwudHd0LOxp4zPaE6wsw4cm0u-dnbAE3zkJf_EPwBnMgL-ouSOKjPH7XYg9fCjnLnY54aWX_H7TDiPgFArTOsrllskNYr_X4sWP-rPHKlWdAzDh9GBMK4vAgJxMthj0jssLvjDAkK1l2MDp-nOLtdFCtF7-OuorDDcPe_ZV8OgI0iA
Claim type: sub - Claim value: b7539694-97e7-4dfe-84da-b4256e1ff5c7
Claim type: amr - Claim value: pwd
Claim type: given_name - Claim value: Claire
Claim type: family_name - Claim value: Underwood
Claim type: role - Claim value: PayingUser
Claim type: country - Claim value: be
Claim type: subscriptionlevel - Claim value: PayingUser
================================ OIDC IDENTITY TOKEN INFO ======================================

QQHQ ***********************************************************************************************************************************************
QQHQ :: ...*CALLING API

QQHQ :: EXTRACT ACCESS TOKEN EXPIRATION
QQHQ :: ACCESS TOKEN EXPIRED

QQHQ :: ...*GET OIDC DISCOVERY

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/.well-known/openid-configuration
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
IdentityServer4.Endpoints.DiscoveryEndpoint:Debug: Start discovery request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 11.8424ms 200 application/json; charset=UTF-8

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/.well-known/openid-configuration/jwks
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
IdentityServer4.Endpoints.DiscoveryKeyEndpoint:Debug: Start key discovery request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 11.3098ms 200 application/jwk-set+json; charset=UTF-8

QQHQ :: EXTRACT REFRESH TOKEN

QQHQ :: ...*RENEW TOKENS

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST https://localhost:44314/connect/token application/x-www-form-urlencoded 166
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/token matched to endpoint type Token
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
IdentityServer4.Endpoints.TokenEndpoint:Debug: Start token request.
IdentityServer4.Validation.ClientSecretValidator:Debug: Start client validation
IdentityServer4.Validation.BasicAuthenticationSecretParser:Debug: Start parsing Basic Authentication secret
IdentityServer4.Validation.PostBodySecretParser:Debug: Start parsing for secret in post body
IdentityServer4.Validation.SecretParser:Debug: Parser found secret: PostBodySecretParser
IdentityServer4.Validation.SecretParser:Debug: Secret id found: imagegalleryclient
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.SecretValidator:Debug: Secret validator success: HashedSharedSecretValidator
IdentityServer4.Validation.ClientSecretValidator:Debug: Client validation success
IdentityServer4.Validation.TokenRequestValidator:Debug: Start token request validation
IdentityServer4.Validation.TokenRequestValidator:Debug: Start validation of refresh token request
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: RefreshTokenValidation
IdentityServer4.Validation.TokenValidator:Debug: Token validation success
{
  "ClientId": "imagegalleryclient",
  "ClientName": "Image Gallery",
  "ValidateLifetime": false,
  "Claims": {
    "sub": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
    "client_id": "imagegalleryclient",
    "scope": [
      "openid",
      "profile",
      "address",
      "roles",
      "country",
      "subscriptionlevel",
      "imagegalleryapi",
      "offline_access"
    ],
    "auth_time": 1559311430,
    "idp": "local",
    "amr": "pwd",
    "role": "PayingUser"
  }
}
IdentityServer4.Validation.TokenRequestValidator:Debug: Validation of refresh token request success
IdentityServer4.Validation.TokenRequestValidator:Information: Token request validation success
{
  "ClientId": "imagegalleryclient",
  "ClientName": "Image Gallery",
  "GrantType": "refresh_token",
  "RefreshToken": "49884c23fe6a1debd8e329c0516a0861bf6eff6c8608d70a0650f6bc12541c97",
  "Raw": {
    "grant_type": "refresh_token",
    "refresh_token": "***REDACTED***",
    "client_id": "imagegalleryclient",
    "client_secret": "***REDACTED***"
  }
}
IdentityServer4.Services.DefaultClaimsService:Debug: Getting claims for access token for client: imagegalleryclient
IdentityServer4.Services.DefaultClaimsService:Debug: Getting claims for access token for subject: b7539694-97e7-4dfe-84da-b4256e1ff5c7
IdentityServer4.Test.TestUserProfileService:Debug: Get profile called for subject b7539694-97e7-4dfe-84da-b4256e1ff5c7 from client Image Gallery with claim types role via ClaimsProviderAccessToken
IdentityServer4.Test.TestUserProfileService:Debug: Issued claims: role
IdentityServer4.Services.DefaultRefreshTokenService:Debug: Updating refresh token
IdentityServer4.Services.DefaultRefreshTokenService:Debug: Token usage is one-time only. Generating new handle
IdentityServer4.Services.DefaultRefreshTokenService:Debug: Created refresh token in store
IdentityServer4.Services.DefaultClaimsService:Debug: Getting claims for identity token for subject: b7539694-97e7-4dfe-84da-b4256e1ff5c7 and client: imagegalleryclient
IdentityServer4.Services.DefaultClaimsService:Debug: In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
IdentityServer4.Endpoints.TokenEndpoint:Debug: Token request success.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 83.4005ms 200 application/json; charset=UTF-8

QQHQ :: SIGN IN TO UPDATE TOKENS

Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler:Information: AuthenticationScheme: Cookies signed in.

QQHQ :: SET BEARER ACCESS TOKEN...CALLING API

Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G8" started.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44329/api/images
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Trace: All hosts are allowed.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Debug: The request path /api/images does not match a supported file type
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: HandleAuthenticateAsync called
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: Token found: 1362085f4227a4a1ced764a51539547789179eff72128e72f3a0c091578585dc
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: Token is a reference token and is supported.

QQHQ :: API :: ...**VALIDATE ACCESS TOKEN

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST https://localhost:44314/connect/introspect application/x-www-form-urlencoded 156
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/introspect matched to endpoint type Introspection
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
IdentityServer4.Endpoints.IntrospectionEndpoint:Debug: Starting introspection request.
IdentityServer4.Validation.BasicAuthenticationSecretParser:Debug: Start parsing Basic Authentication secret
IdentityServer4.Validation.PostBodySecretParser:Debug: Start parsing for secret in post body
IdentityServer4.Validation.SecretParser:Debug: Parser found secret: PostBodySecretParser
IdentityServer4.Validation.SecretParser:Debug: Secret id found: imagegalleryapi
IdentityServer4.Validation.SecretValidator:Debug: Secret validator success: HashedSharedSecretValidator
IdentityServer4.Validation.ApiSecretValidator:Debug: API resource validation success
IdentityServer4.Validation.IntrospectionRequestValidator:Debug: Introspection request validation started.
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: AccessTokenValidation
IdentityServer4.Validation.TokenValidator:Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
IdentityServer4.Validation.TokenValidator:Debug: Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "1362085f4227a4a1ced764a51539547789179eff72128e72f3a0c091578585dc",
  "Claims": {
    "iss": "https://localhost:44314",
    "nbf": 1559311571,
    "exp": 1559311691,
    "aud": [
      "https://localhost:44314/resources",
      "imagegalleryapi"
    ],
    "client_id": "imagegalleryclient",
    "scope": [
      "openid",
      "profile",
      "address",
      "roles",
      "country",
      "subscriptionlevel",
      "imagegalleryapi",
      "offline_access"
    ],
    "sub": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
    "auth_time": 1559311430,
    "idp": "local",
    "amr": "pwd",
    "role": "PayingUser"
  }
}
IdentityServer4.Validation.IntrospectionRequestValidator:Debug: Introspection request validation successful.
IdentityServer4.ResponseHandling.IntrospectionResponseGenerator:Debug: Creating introspection response for active token.
IdentityServer4.Endpoints.IntrospectionEndpoint:Information: Success token introspection. Token active: True, for API name: imagegalleryapi
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 41.887ms 200 application/json; charset=UTF-8
IdentityModel.AspNetCore.OAuth2Introspection.OAuth2IntrospectionHandler:Debug: AuthenticationScheme: BearerIdentityServerAuthenticationIntrospection was successfully authenticated.
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Debug: AuthenticationScheme: Bearer was successfully authenticated.

QQHQ :: API :: ...EXECUTE API

Microsoft.AspNetCore.Routing.Tree.TreeRouter:Debug: Request successfully matched the route with name '(null)' and template 'api/images'
Microsoft.AspNetCore.Mvc.Internal.ActionSelector:Debug: Action 'ImageGallery.API.Controllers.ImagesController.CreateImage (ImageGallery.API)' with id '763a4689-3a85-4433-a233-a44ca510cb2b' did not match the constraint 'Microsoft.AspNetCore.Mvc.Internal.HttpMethodActionConstraint'
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "GetImages", controller = "Images"}. Executing action ImageGallery.API.Controllers.ImagesController.GetImages (ImageGallery.API)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of authorization filters (in the following order): Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of resource filters (in the following order): Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of action filters (in the following order): Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter (Order: -2147483648), Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of exception filters (in the following order): None
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of result filters (in the following order): Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: Before executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: After executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: Before executing OnResourceExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: After executing OnResourceExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecutionAsync on filter Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecuting on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecuting on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method ImageGallery.API.Controllers.ImagesController.GetImages (ImageGallery.API) - Validation state: Valid
Microsoft.EntityFrameworkCore.Infrastructure:Information: Entity Framework Core 2.2.3-servicing-35854 initialized 'GalleryContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[@__ownerId_0='?' (Size = 50)], CommandType='Text', CommandTimeout='30']
SELECT [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
FROM [Images] AS [i]
WHERE [i].[OwnerId] = @__ownerId_0
ORDER BY [i].[Title]
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (12ms) [Parameters=[@__ownerId_0='?' (Size = 50)], CommandType='Text', CommandTimeout='30']
SELECT [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
FROM [Images] AS [i]
WHERE [i].[OwnerId] = @__ownerId_0
ORDER BY [i].[Title]
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.Database.Command:Debug: A data reader was disposed.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method ImageGallery.API.Controllers.ImagesController.GetImages (ImageGallery.API), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 45.3233ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecuted on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecuted on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecutionAsync on filter Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: Before executing OnResultExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: After executing OnResultExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Before executing action result Microsoft.AspNetCore.Mvc.OkObjectResult.
Microsoft.AspNetCore.Mvc.Infrastructure.DefaultOutputFormatterSelector:Debug: List of registered output formatters, in the following order: Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter, Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter, Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter, Microsoft.AspNetCore.Mvc.Formatters.JsonOutputFormatter
Microsoft.AspNetCore.Mvc.Infrastructure.DefaultOutputFormatterSelector:Debug: Attempting to select an output formatter based on Accept header 'application/json'.
Microsoft.AspNetCore.Mvc.Infrastructure.DefaultOutputFormatterSelector:Debug: Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.JsonOutputFormatter' and content type 'application/json' to write the response.
Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor:Information: Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[ImageGallery.Model.Image, ImageGallery.Model, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: After executing action result Microsoft.AspNetCore.Mvc.OkObjectResult.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: Before executing OnResultExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: After executing OnResultExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: Before executing OnResourceExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: After executing OnResourceExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.API.Controllers.ImagesController.GetImages (ImageGallery.API) in 101.2891ms
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G8" completed keep alive response.
Microsoft.EntityFrameworkCore.Infrastructure:Debug: 'GalleryContext' disposed.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 199.7766ms 200 application/json; charset=utf-8


QQHQ :: ...RENDERING HOME PAGE

Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client), returned result Microsoft.AspNetCore.Mvc.ViewResult in 460.2096ms.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executing ViewResult, running view Index.
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executed ViewResult - view Index executed in 8.256ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client) in 487.023ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 535.1163ms 200 text/html; charset=utf-8


QQHQ ***********************************************************************************************************************************************
QQHQ :: HOME PAGE SHOWN...5.EDIT IMAGE


Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/Gallery/EditImage/2645bd94-3624-43fc-b21f-1209d730fc71
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "EditImage", controller = "Gallery"}. Executing action ImageGallery.Client.Controllers.GalleryController.EditImage (ImageGallery.Client)
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method ImageGallery.Client.Controllers.GalleryController.EditImage (ImageGallery.Client) with arguments (2645bd94-3624-43fc-b21f-1209d730fc71) - Validation state: Valid
QQHQ :: EXTRACT ID TOKEN
================================ OIDC IDENTITY TOKEN INFO ======================================
Identity token: eyJhbGciOiJSUzI1NiIsImtpZCI6IjAzOGRiNTljYmM4ZDAxOWI1MjQ1YzNhODIzYWM5MTg3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTkzMTE1NzEsImV4cCI6MTU1OTMxMTg3MSwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NDQzMTQiLCJhdWQiOiJpbWFnZWdhbGxlcnljbGllbnQiLCJpYXQiOjE1NTkzMTE1NzEsImF0X2hhc2giOiJab1V3TVlQci0yVTluZGVKdGVzU0tBIiwic3ViIjoiYjc1Mzk2OTQtOTdlNy00ZGZlLTg0ZGEtYjQyNTZlMWZmNWM3IiwiYXV0aF90aW1lIjoxNTU5MzExNDMwLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.id7Z6FxtTzIaAcx3gm_DfSAKu5AsFAfL0pxhlI2I0iQye6_AhuxurfGZ7yXudxlswonfG18PA9DS3SErhUwaXYhmUYO3-iwo1msAItFyQNBLsCQ4mtjaErSDIbj22sJ08mGUvZUnsGEKAQTD7Zv7qvZGsybeZxLxgz1SW7tn6yM6F2EmA3IX34f4BrcLSkYT9Se0PgYAbYnYQWKC-vQdXMl6bESMZbJBzcBdHfO84Y8P-Ogn40-f51Z70GXj4V08MIb1jWVNInY7IxKvEK6W27doVyZ_lH6sjNh8-3hGC2oWDh2TLZyxFuBz0arpNC8CUeJiywJNpNU3MvZEgo1JBw
Claim type: sub - Claim value: b7539694-97e7-4dfe-84da-b4256e1ff5c7
Claim type: amr - Claim value: pwd
Claim type: given_name - Claim value: Claire
Claim type: family_name - Claim value: Underwood
Claim type: role - Claim value: PayingUser
Claim type: country - Claim value: be
Claim type: subscriptionlevel - Claim value: PayingUser
================================ OIDC IDENTITY TOKEN INFO ======================================


QQHQ ***********************************************************************************************************************************************
QQHQ :: ...*CALLING API

QQHQ :: EXTRACT ACCESS TOKEN EXPIRATION
QQHQ :: EXTRACT ACCESS TOKEN
QQHQ :: SET BEARER ACCESS TOKEN...CALLING API

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44329/api/images/2645bd94-3624-43fc-b21f-1209d730fc71
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Trace: All hosts are allowed.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Debug: The request path /api/images/2645bd94-3624-43fc-b21f-1209d730fc71 does not match a supported file type
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: HandleAuthenticateAsync called
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: Token found: 1362085f4227a4a1ced764a51539547789179eff72128e72f3a0c091578585dc
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: Token is a reference token and is supported.

QQHQ :: API :: ...**VALIDATE ACCESS TOKEN

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST https://localhost:44314/connect/introspect application/x-www-form-urlencoded 156
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/introspect matched to endpoint type Introspection
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
IdentityServer4.Endpoints.IntrospectionEndpoint:Debug: Starting introspection request.
IdentityServer4.Validation.BasicAuthenticationSecretParser:Debug: Start parsing Basic Authentication secret
IdentityServer4.Validation.PostBodySecretParser:Debug: Start parsing for secret in post body
IdentityServer4.Validation.SecretParser:Debug: Parser found secret: PostBodySecretParser
IdentityServer4.Validation.SecretParser:Debug: Secret id found: imagegalleryapi
IdentityServer4.Validation.SecretValidator:Debug: Secret validator success: HashedSharedSecretValidator
IdentityServer4.Validation.ApiSecretValidator:Debug: API resource validation success
IdentityServer4.Validation.IntrospectionRequestValidator:Debug: Introspection request validation started.
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: AccessTokenValidation
IdentityServer4.Validation.TokenValidator:Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
IdentityServer4.Validation.TokenValidator:Debug: Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "1362085f4227a4a1ced764a51539547789179eff72128e72f3a0c091578585dc",
  "Claims": {
    "iss": "https://localhost:44314",
    "nbf": 1559311571,
    "exp": 1559311691,
    "aud": [
      "https://localhost:44314/resources",
      "imagegalleryapi"
    ],
    "client_id": "imagegalleryclient",
    "scope": [
      "openid",
      "profile",
      "address",
      "roles",
      "country",
      "subscriptionlevel",
      "imagegalleryapi",
      "offline_access"
    ],
    "sub": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
    "auth_time": 1559311430,
    "idp": "local",
    "amr": "pwd",
    "role": "PayingUser"
  }
}
IdentityServer4.Validation.IntrospectionRequestValidator:Debug: Introspection request validation successful.
IdentityServer4.ResponseHandling.IntrospectionResponseGenerator:Debug: Creating introspection response for active token.
IdentityServer4.Endpoints.IntrospectionEndpoint:Information: Success token introspection. Token active: True, for API name: imagegalleryapi
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 37.7869ms 200 application/json; charset=UTF-8
IdentityModel.AspNetCore.OAuth2Introspection.OAuth2IntrospectionHandler:Debug: AuthenticationScheme: BearerIdentityServerAuthenticationIntrospection was successfully authenticated.
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Debug: AuthenticationScheme: Bearer was successfully authenticated.

QQHQ :: API :: ...EXECUTE API

Microsoft.AspNetCore.Routing.Tree.TreeRouter:Debug: Request successfully matched the route with name 'GetImage' and template 'api/images/{id}'
Microsoft.AspNetCore.Mvc.Internal.ActionSelector:Debug: Action 'ImageGallery.API.Controllers.ImagesController.DeleteImage (ImageGallery.API)' with id '66bbb7e5-2b04-4179-8aee-1c071f4b4c53' did not match the constraint 'Microsoft.AspNetCore.Mvc.Internal.HttpMethodActionConstraint'
Microsoft.AspNetCore.Mvc.Internal.ActionSelector:Debug: Action 'ImageGallery.API.Controllers.ImagesController.UpdateImage (ImageGallery.API)' with id '3b9b3f6d-d330-4690-8cda-4a94a2d23df9' did not match the constraint 'Microsoft.AspNetCore.Mvc.Internal.HttpMethodActionConstraint'
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "GetImage", controller = "Images"}. Executing action ImageGallery.API.Controllers.ImagesController.GetImage (ImageGallery.API)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of authorization filters (in the following order): Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter, Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of resource filters (in the following order): Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of action filters (in the following order): Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter (Order: -2147483648), Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of exception filters (in the following order): None
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of result filters (in the following order): Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: Before executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: After executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: Before executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.EntityFrameworkCore.Infrastructure:Information: Entity Framework Core 2.2.3-servicing-35854 initialized 'GalleryContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
Microsoft.EntityFrameworkCore.Query:Debug: Compiling query model:
'(from Image i in DbSet<Image>
where [i].Id == __id_0 && [i].OwnerId == __ownerId_1
select [i]).Any()'
Microsoft.EntityFrameworkCore.Query:Debug: Optimized query model:
'(from Image i in DbSet<Image>
where [i].Id == __id_0 && [i].OwnerId == __ownerId_1
select [i]).Any()'
Microsoft.EntityFrameworkCore.Query:Debug: (QueryContext queryContext) => IEnumerable<bool> _InterceptExceptions(
|__ source: IEnumerable<bool> _ToSequence(() => bool GetResult(
|   |__ valueBuffers: IEnumerable<ValueBuffer> _Query(
|   |   |__ queryContext: queryContext,
|   |   |__ shaperCommandContext: SelectExpression:
|   |           SELECT CASE
|   |               WHEN EXISTS (
|   |                   SELECT 1
|   |                   FROM [Images] AS [i]
|   |                   WHERE ([i].[Id] = @__id_0) AND ([i].[OwnerId] = @__ownerId_1))
|   |               THEN CAST(1 AS BIT) ELSE CAST(0 AS BIT)
|   |           END),
|   |__ throwOnNullResult: False)),
|__ contextType: ImageGallery.API.Entities.GalleryContext,
|__ logger: DiagnosticsLogger<Query>,
|__ queryContext: queryContext)
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid), @__ownerId_1='?' (Size = 50)], CommandType='Text', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Images] AS [i]
        WHERE ([i].[Id] = @__id_0) AND ([i].[OwnerId] = @__ownerId_1))
    THEN CAST(1 AS BIT) ELSE CAST(0 AS BIT)
END
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Guid), @__ownerId_1='?' (Size = 50)], CommandType='Text', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Images] AS [i]
        WHERE ([i].[Id] = @__id_0) AND ([i].[OwnerId] = @__ownerId_1))
    THEN CAST(1 AS BIT) ELSE CAST(0 AS BIT)
END
Microsoft.EntityFrameworkCore.Database.Command:Debug: A data reader was disposed.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: After executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: Before executing OnResourceExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: After executing OnResourceExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.ModelBinding.ParameterBinder:Debug: Attempting to bind parameter 'id' of type 'System.Guid' ...
Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinder:Debug: Attempting to bind model of type 'System.Guid' using the name 'id' in request data ...
Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinder:Debug: Done attempting to bind model of type 'System.Guid' using the name 'id'.
Microsoft.AspNetCore.Mvc.ModelBinding.ParameterBinder:Debug: Done attempting to bind parameter 'id' of type 'System.Guid'.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecutionAsync on filter Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecuting on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecuting on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method ImageGallery.API.Controllers.ImagesController.GetImage (ImageGallery.API) with arguments (2645bd94-3624-43fc-b21f-1209d730fc71) - Validation state: Valid
Microsoft.EntityFrameworkCore.Query:Debug: Compiling query model:
'(from Image i in DbSet<Image>
where [i].Id == __id_0
select [i]).FirstOrDefault()'
Microsoft.EntityFrameworkCore.Query:Debug: Optimized query model:
'(from Image i in DbSet<Image>
where [i].Id == __id_0
select [i]).FirstOrDefault()'
Microsoft.EntityFrameworkCore.Query:Debug: (QueryContext queryContext) => IEnumerable<Image> _InterceptExceptions(
|__ source: IEnumerable<Image> _TrackEntities(
|   |__ results: IEnumerable<Image> _ToSequence(() => Image FirstOrDefault(IEnumerable<Image> _ShapedQuery(
|   |   |__ queryContext: queryContext,
|   |   |__ shaperCommandContext: SelectExpression:
|   |   |       SELECT TOP(1) [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
|   |   |       FROM [Images] AS [i]
|   |   |       WHERE [i].[Id] = @__id_0,
|   |   |__ shaper: (MaterializationContext materializationContext) =>
|   |       {
|   |           instance = new Image()
|   |           instance.<Id>k__BackingField = Guid TryReadValue(ValueBuffer materializationContext.get_ValueBuffer(), 0, Image.Id)
|   |           instance.<FileName>k__BackingField = string TryReadValue(ValueBuffer materializationContext.get_ValueBuffer(), 1, Image.FileName)
|   |           instance.<OwnerId>k__BackingField = string TryReadValue(ValueBuffer materializationContext.get_ValueBuffer(), 2, Image.OwnerId)
|   |           instance.<Title>k__BackingField = string TryReadValue(ValueBuffer materializationContext.get_ValueBuffer(), 3, Image.Title)
|   |           return instance
|   |       }))),
|   |__ queryContext: queryContext,
|   |__ entityTrackingInfos: { itemType: Image },
|   |__ entityAccessors: List<Func<Image, object>>
|       {
|           Func<Image, Image>,
|       }),
|__ contextType: ImageGallery.API.Entities.GalleryContext,
|__ logger: DiagnosticsLogger<Query>,
|__ queryContext: queryContext)
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
FROM [Images] AS [i]
WHERE [i].[Id] = @__id_0
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
FROM [Images] AS [i]
WHERE [i].[Id] = @__id_0
Microsoft.EntityFrameworkCore.Database.Command:Debug: A data reader was disposed.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method ImageGallery.API.Controllers.ImagesController.GetImage (ImageGallery.API), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 39.9711ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecuted on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecuted on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecutionAsync on filter Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: Before executing OnResultExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: After executing OnResultExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Before executing action result Microsoft.AspNetCore.Mvc.OkObjectResult.
Microsoft.AspNetCore.Mvc.Infrastructure.DefaultOutputFormatterSelector:Debug: List of registered output formatters, in the following order: Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter, Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter, Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter, Microsoft.AspNetCore.Mvc.Formatters.JsonOutputFormatter
Microsoft.AspNetCore.Mvc.Infrastructure.DefaultOutputFormatterSelector:Debug: Attempting to select an output formatter based on Accept header 'application/json'.
Microsoft.AspNetCore.Mvc.Infrastructure.DefaultOutputFormatterSelector:Debug: Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.JsonOutputFormatter' and content type 'application/json' to write the response.
Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor:Information: Executing ObjectResult, writing value of type 'ImageGallery.Model.Image'.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: After executing action result Microsoft.AspNetCore.Mvc.OkObjectResult.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: Before executing OnResultExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: After executing OnResultExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: Before executing OnResourceExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: After executing OnResourceExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.API.Controllers.ImagesController.GetImage (ImageGallery.API) in 163.6507ms
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G8" completed keep alive response.
Microsoft.EntityFrameworkCore.Infrastructure:Debug: 'GalleryContext' disposed.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 278.4854ms 200 application/json; charset=utf-8

QQHQ :: ...RENDERING EDIT PAGE

Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method ImageGallery.Client.Controllers.GalleryController.EditImage (ImageGallery.Client), returned result Microsoft.AspNetCore.Mvc.ViewResult in 329.5333ms.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executing ViewResult, running view EditImage.
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executed ViewResult - view EditImage executed in 49.7504ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.Client.Controllers.GalleryController.EditImage (ImageGallery.Client) in 408.8866ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 427.3841ms 200 text/html; charset=utf-8


QQHQ ***********************************************************************************************************************************************
QQHQ :: EDIT PAGE SHOWN...6.EDIT

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST http://localhost:44393/Gallery/EditImage/2645bd94-3624-43fc-b21f-1209d730fc71 application/x-www-form-urlencoded 252
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "EditImage", controller = "Gallery"}. Executing action ImageGallery.Client.Controllers.GalleryController.EditImage (ImageGallery.Client)
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method ImageGallery.Client.Controllers.GalleryController.EditImage (ImageGallery.Client) with arguments (ImageGallery.Client.ViewModels.EditImageViewModel) - Validation state: Valid

QQHQ :: ...*CALLING API

QQHQ :: EXTRACT ACCESS TOKEN EXPIRATION
QQHQ :: ACCESS TOKEN EXPIRED

QQHQ :: ...*GET OIDC DISCOVERY

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/.well-known/openid-configuration
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
IdentityServer4.Endpoints.DiscoveryEndpoint:Debug: Start discovery request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 10.6382ms 200 application/json; charset=UTF-8

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/.well-known/openid-configuration/jwks
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
IdentityServer4.Endpoints.DiscoveryKeyEndpoint:Debug: Start key discovery request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 9.9792ms 200 application/jwk-set+json; charset=UTF-8

QQHQ :: EXTRACT REFRESH TOKEN

QQHQ :: ...*RENEW TOKENS

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST https://localhost:44314/connect/token application/x-www-form-urlencoded 166
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/token matched to endpoint type Token
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
IdentityServer4.Endpoints.TokenEndpoint:Debug: Start token request.
IdentityServer4.Validation.ClientSecretValidator:Debug: Start client validation
IdentityServer4.Validation.BasicAuthenticationSecretParser:Debug: Start parsing Basic Authentication secret
IdentityServer4.Validation.PostBodySecretParser:Debug: Start parsing for secret in post body
IdentityServer4.Validation.SecretParser:Debug: Parser found secret: PostBodySecretParser
IdentityServer4.Validation.SecretParser:Debug: Secret id found: imagegalleryclient
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.SecretValidator:Debug: Secret validator success: HashedSharedSecretValidator
IdentityServer4.Validation.ClientSecretValidator:Debug: Client validation success
IdentityServer4.Validation.TokenRequestValidator:Debug: Start token request validation
IdentityServer4.Validation.TokenRequestValidator:Debug: Start validation of refresh token request
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: RefreshTokenValidation
IdentityServer4.Validation.TokenValidator:Debug: Token validation success
{
  "ClientId": "imagegalleryclient",
  "ClientName": "Image Gallery",
  "ValidateLifetime": false,
  "Claims": {
    "sub": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
    "client_id": "imagegalleryclient",
    "scope": [
      "openid",
      "profile",
      "address",
      "roles",
      "country",
      "subscriptionlevel",
      "imagegalleryapi",
      "offline_access"
    ],
    "auth_time": 1559311430,
    "idp": "local",
    "amr": "pwd",
    "role": "PayingUser"
  }
}
IdentityServer4.Validation.TokenRequestValidator:Debug: Validation of refresh token request success
IdentityServer4.Validation.TokenRequestValidator:Information: Token request validation success
{
  "ClientId": "imagegalleryclient",
  "ClientName": "Image Gallery",
  "GrantType": "refresh_token",
  "RefreshToken": "5e812c9c2a9d1146ff104a0e3fd39ba492f83ecea02037044f2be9fe26836892",
  "Raw": {
    "grant_type": "refresh_token",
    "refresh_token": "***REDACTED***",
    "client_id": "imagegalleryclient",
    "client_secret": "***REDACTED***"
  }
}
IdentityServer4.Services.DefaultClaimsService:Debug: Getting claims for access token for client: imagegalleryclient
IdentityServer4.Services.DefaultClaimsService:Debug: Getting claims for access token for subject: b7539694-97e7-4dfe-84da-b4256e1ff5c7
IdentityServer4.Test.TestUserProfileService:Debug: Get profile called for subject b7539694-97e7-4dfe-84da-b4256e1ff5c7 from client Image Gallery with claim types role via ClaimsProviderAccessToken
IdentityServer4.Test.TestUserProfileService:Debug: Issued claims: role
IdentityServer4.Services.DefaultRefreshTokenService:Debug: Updating refresh token
IdentityServer4.Services.DefaultRefreshTokenService:Debug: Token usage is one-time only. Generating new handle
IdentityServer4.Services.DefaultRefreshTokenService:Debug: Created refresh token in store
IdentityServer4.Services.DefaultClaimsService:Debug: Getting claims for identity token for subject: b7539694-97e7-4dfe-84da-b4256e1ff5c7 and client: imagegalleryclient
IdentityServer4.Services.DefaultClaimsService:Debug: In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
IdentityServer4.Endpoints.TokenEndpoint:Debug: Token request success.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 58.703ms 200 application/json; charset=UTF-8

QQHQ :: SIGN IN TO UPDATE TOKENS
Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler:Information: AuthenticationScheme: Cookies signed in.

QQHQ :: SET BEARER ACCESS TOKEN...CALLING API

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 PUT http://localhost:44329/api/images/2645bd94-3624-43fc-b21f-1209d730fc71 application/json; charset=utf-16 64
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Trace: All hosts are allowed.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Debug: PUT requests are not supported
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: HandleAuthenticateAsync called
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: Token found: 5d5144dff4c5a78271730d133d431fddf0555f6af46eabc65f3795bc1439f022
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: Token is a reference token and is supported.

QQHQ :: API :: ...**VALIDATE ACCESS TOKEN

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST https://localhost:44314/connect/introspect application/x-www-form-urlencoded 156
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/introspect matched to endpoint type Introspection
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
IdentityServer4.Endpoints.IntrospectionEndpoint:Debug: Starting introspection request.
IdentityServer4.Validation.BasicAuthenticationSecretParser:Debug: Start parsing Basic Authentication secret
IdentityServer4.Validation.PostBodySecretParser:Debug: Start parsing for secret in post body
IdentityServer4.Validation.SecretParser:Debug: Parser found secret: PostBodySecretParser
IdentityServer4.Validation.SecretParser:Debug: Secret id found: imagegalleryapi
IdentityServer4.Validation.SecretValidator:Debug: Secret validator success: HashedSharedSecretValidator
IdentityServer4.Validation.ApiSecretValidator:Debug: API resource validation success
IdentityServer4.Validation.IntrospectionRequestValidator:Debug: Introspection request validation started.
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: AccessTokenValidation
IdentityServer4.Validation.TokenValidator:Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
IdentityServer4.Validation.TokenValidator:Debug: Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "5d5144dff4c5a78271730d133d431fddf0555f6af46eabc65f3795bc1439f022",
  "Claims": {
    "iss": "https://localhost:44314",
    "nbf": 1559311664,
    "exp": 1559311784,
    "aud": [
      "https://localhost:44314/resources",
      "imagegalleryapi"
    ],
    "client_id": "imagegalleryclient",
    "scope": [
      "openid",
      "profile",
      "address",
      "roles",
      "country",
      "subscriptionlevel",
      "imagegalleryapi",
      "offline_access"
    ],
    "sub": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
    "auth_time": 1559311430,
    "idp": "local",
    "amr": "pwd",
    "role": "PayingUser"
  }
}
IdentityServer4.Validation.IntrospectionRequestValidator:Debug: Introspection request validation successful.
IdentityServer4.ResponseHandling.IntrospectionResponseGenerator:Debug: Creating introspection response for active token.
IdentityServer4.Endpoints.IntrospectionEndpoint:Information: Success token introspection. Token active: True, for API name: imagegalleryapi
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 48.1707ms 200 application/json; charset=UTF-8
IdentityModel.AspNetCore.OAuth2Introspection.OAuth2IntrospectionHandler:Debug: AuthenticationScheme: BearerIdentityServerAuthenticationIntrospection was successfully authenticated.
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Debug: AuthenticationScheme: Bearer was successfully authenticated.

QQHQ :: API :: ...EXECUTE API

Microsoft.AspNetCore.Routing.Tree.TreeRouter:Debug: Request successfully matched the route with name 'GetImage' and template 'api/images/{id}'
Microsoft.AspNetCore.Mvc.Internal.ActionSelector:Debug: Action 'ImageGallery.API.Controllers.ImagesController.GetImage (ImageGallery.API)' with id 'eb680387-226c-408f-86bb-b28ec48fd52c' did not match the constraint 'Microsoft.AspNetCore.Mvc.Internal.HttpMethodActionConstraint'
Microsoft.AspNetCore.Mvc.Internal.ActionSelector:Debug: Action 'ImageGallery.API.Controllers.ImagesController.DeleteImage (ImageGallery.API)' with id '66bbb7e5-2b04-4179-8aee-1c071f4b4c53' did not match the constraint 'Microsoft.AspNetCore.Mvc.Internal.HttpMethodActionConstraint'
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "UpdateImage", controller = "Images"}. Executing action ImageGallery.API.Controllers.ImagesController.UpdateImage (ImageGallery.API)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of authorization filters (in the following order): Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter, Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of resource filters (in the following order): Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of action filters (in the following order): Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter (Order: -2147483648), Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of exception filters (in the following order): None
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of result filters (in the following order): Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: Before executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: After executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: Before executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.EntityFrameworkCore.Infrastructure:Information: Entity Framework Core 2.2.3-servicing-35854 initialized 'GalleryContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid), @__ownerId_1='?' (Size = 50)], CommandType='Text', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Images] AS [i]
        WHERE ([i].[Id] = @__id_0) AND ([i].[OwnerId] = @__ownerId_1))
    THEN CAST(1 AS BIT) ELSE CAST(0 AS BIT)
END
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Guid), @__ownerId_1='?' (Size = 50)], CommandType='Text', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Images] AS [i]
        WHERE ([i].[Id] = @__id_0) AND ([i].[OwnerId] = @__ownerId_1))
    THEN CAST(1 AS BIT) ELSE CAST(0 AS BIT)
END
Microsoft.EntityFrameworkCore.Database.Command:Debug: A data reader was disposed.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: After executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: Before executing OnResourceExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: After executing OnResourceExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.ModelBinding.ParameterBinder:Debug: Attempting to bind parameter 'id' of type 'System.Guid' ...
Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinder:Debug: Attempting to bind model of type 'System.Guid' using the name 'id' in request data ...
Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinder:Debug: Done attempting to bind model of type 'System.Guid' using the name 'id'.
Microsoft.AspNetCore.Mvc.ModelBinding.ParameterBinder:Debug: Done attempting to bind parameter 'id' of type 'System.Guid'.
Microsoft.AspNetCore.Mvc.ModelBinding.ParameterBinder:Debug: Attempting to bind parameter 'imageForUpdate' of type 'ImageGallery.Model.ImageForUpdate' ...
Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinder:Debug: Attempting to bind model of type 'ImageGallery.Model.ImageForUpdate' using the name '' in request data ...
Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinder:Debug: Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.JsonPatchInputFormatter' for content type 'application/json; charset=utf-16'.
Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinder:Debug: Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.JsonInputFormatter' for content type 'application/json; charset=utf-16'.
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G8", Request id "0HLN5Q2LN75G8:00000003": started reading request body.
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G8", Request id "0HLN5Q2LN75G8:00000003": done reading request body.
Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinder:Debug: Done attempting to bind model of type 'ImageGallery.Model.ImageForUpdate' using the name ''.
Microsoft.AspNetCore.Mvc.ModelBinding.ParameterBinder:Debug: Done attempting to bind parameter 'imageForUpdate' of type 'ImageGallery.Model.ImageForUpdate'.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecutionAsync on filter Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecuting on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecuting on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method ImageGallery.API.Controllers.ImagesController.UpdateImage (ImageGallery.API) with arguments (2645bd94-3624-43fc-b21f-1209d730fc71, ImageGallery.Model.ImageForUpdate) - Validation state: Valid
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
FROM [Images] AS [i]
WHERE [i].[Id] = @__id_0
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='Text', CommandTimeout='30']
SELECT TOP(1) [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
FROM [Images] AS [i]
WHERE [i].[Id] = @__id_0
Microsoft.EntityFrameworkCore.Database.Command:Debug: A data reader was disposed.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.Update:Debug: SaveChanges starting for 'GalleryContext'.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: DetectChanges starting for 'GalleryContext'.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Unchanged 'Image.Title' detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Unchanged' to 'Modified'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: DetectChanges completed for 'GalleryContext'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Transaction:Debug: Beginning transaction with isolation level 'ReadCommitted'.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Size = 150)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Images] SET [Title] = @p0
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (4ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Size = 150)], CommandType='Text', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Images] SET [Title] = @p0
WHERE [Id] = @p1;
SELECT @@ROWCOUNT;
Microsoft.EntityFrameworkCore.Database.Command:Debug: A data reader was disposed.
Microsoft.EntityFrameworkCore.Database.Transaction:Debug: Committing transaction.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Transaction:Debug: Disposing transaction.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: An 'Image' entity tracked by 'GalleryContext' changed from 'Modified' to 'Unchanged'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.Update:Debug: SaveChanges completed for 'GalleryContext' with 1 entities written to the database.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method ImageGallery.API.Controllers.ImagesController.UpdateImage (ImageGallery.API), returned result Microsoft.AspNetCore.Mvc.NoContentResult in 61.102ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecuted on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecuted on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecutionAsync on filter Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: Before executing OnResultExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: After executing OnResultExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Before executing action result Microsoft.AspNetCore.Mvc.NoContentResult.
Microsoft.AspNetCore.Mvc.StatusCodeResult:Information: Executing HttpStatusCodeResult, setting HTTP status code 204
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: After executing action result Microsoft.AspNetCore.Mvc.NoContentResult.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: Before executing OnResultExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: After executing OnResultExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: Before executing OnResourceExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: After executing OnResourceExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.API.Controllers.ImagesController.UpdateImage (ImageGallery.API) in 165.8071ms
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G8" completed keep alive response.
Microsoft.EntityFrameworkCore.Infrastructure:Debug: 'GalleryContext' disposed.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method ImageGallery.Client.Controllers.GalleryController.EditImage (ImageGallery.Client), returned result Microsoft.AspNetCore.Mvc.RedirectToActionResult in 471.2544ms.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 285.4973ms 204

QQHQ ***********************************************************************************************************************************************
QQHQ :: ...*REDIRECT TO ROOT :: ./

Microsoft.AspNetCore.Mvc.RedirectToActionResult:Information: Executing RedirectResult, redirecting to /.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.Client.Controllers.GalleryController.EditImage (ImageGallery.Client) in 500.3277ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 512.5633ms 302

QQHQ :: ...**REDIRECT TO HOME :: http://localhost:44393/

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "Index", controller = "Gallery"}. Executing action ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client)
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client) - Validation state: Valid
QQHQ :: EXTRACT ID TOKEN
================================ OIDC IDENTITY TOKEN INFO ======================================
Identity token: eyJhbGciOiJSUzI1NiIsImtpZCI6IjAzOGRiNTljYmM4ZDAxOWI1MjQ1YzNhODIzYWM5MTg3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTkzMTE2NjQsImV4cCI6MTU1OTMxMTk2NCwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NDQzMTQiLCJhdWQiOiJpbWFnZWdhbGxlcnljbGllbnQiLCJpYXQiOjE1NTkzMTE2NjQsImF0X2hhc2giOiJfZHNQeThxY2tiMkFyZ1YwaktpVTNRIiwic3ViIjoiYjc1Mzk2OTQtOTdlNy00ZGZlLTg0ZGEtYjQyNTZlMWZmNWM3IiwiYXV0aF90aW1lIjoxNTU5MzExNDMwLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.oab_73mm1yNvpVnk8RlQoC9xTt2Rhji1fprPzI1jCjqutoHJLG7onewYfpkR6-SalVyynJZeW_fHTx1PEEWKsKDCc4gqelB2cDPgyxm1kFgzrqTNotbCOf7USbotBvbdLWArbWaNGG7NJ5K6SYcA1iaFRV_fPhN6Xau1sO2qwViV1vy9VS7aDwcOex40OTyiXgxYHkFQbvJDHU1uJ2ykcs2Q-8fqvqpLxROYfzU8hpDc1W47SSCuWM83lukN6qMep6Ue3HviqEPTVdwn4bUu-F4CP2NUUtpO0b7sTc7tU5y5VxWj3OCvhAmUNI8Fr_Cydo9mguMN7XokrW7-90lmVw
Claim type: sub - Claim value: b7539694-97e7-4dfe-84da-b4256e1ff5c7
Claim type: amr - Claim value: pwd
Claim type: given_name - Claim value: Claire
Claim type: family_name - Claim value: Underwood
Claim type: role - Claim value: PayingUser
Claim type: country - Claim value: be
Claim type: subscriptionlevel - Claim value: PayingUser
================================ OIDC IDENTITY TOKEN INFO ======================================

QQHQ ***********************************************************************************************************************************************
QQHQ :: ...*CALLING API

QQHQ :: EXTRACT ACCESS TOKEN EXPIRATION
QQHQ :: EXTRACT ACCESS TOKEN
QQHQ :: SET BEARER ACCESS TOKEN...CALLING API

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44329/api/images
Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware:Trace: All hosts are allowed.
Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware:Debug: The request path /api/images does not match a supported file type
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: HandleAuthenticateAsync called
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: Token found: 5d5144dff4c5a78271730d133d431fddf0555f6af46eabc65f3795bc1439f022
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Trace: Token is a reference token and is supported.

QQHQ :: API :: ...**VALIDATE ACCESS TOKEN

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST https://localhost:44314/connect/introspect application/x-www-form-urlencoded 156
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/introspect matched to endpoint type Introspection
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Introspection, successfully created handler: IdentityServer4.Endpoints.IntrospectionEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.IntrospectionEndpoint for /connect/introspect
IdentityServer4.Endpoints.IntrospectionEndpoint:Debug: Starting introspection request.
IdentityServer4.Validation.BasicAuthenticationSecretParser:Debug: Start parsing Basic Authentication secret
IdentityServer4.Validation.PostBodySecretParser:Debug: Start parsing for secret in post body
IdentityServer4.Validation.SecretParser:Debug: Parser found secret: PostBodySecretParser
IdentityServer4.Validation.SecretParser:Debug: Secret id found: imagegalleryapi
IdentityServer4.Validation.SecretValidator:Debug: Secret validator success: HashedSharedSecretValidator
IdentityServer4.Validation.ApiSecretValidator:Debug: API resource validation success
IdentityServer4.Validation.IntrospectionRequestValidator:Debug: Introspection request validation started.
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: AccessTokenValidation
IdentityServer4.Validation.TokenValidator:Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
IdentityServer4.Validation.TokenValidator:Debug: Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Reference",
  "TokenHandle": "5d5144dff4c5a78271730d133d431fddf0555f6af46eabc65f3795bc1439f022",
  "Claims": {
    "iss": "https://localhost:44314",
    "nbf": 1559311664,
    "exp": 1559311784,
    "aud": [
      "https://localhost:44314/resources",
      "imagegalleryapi"
    ],
    "client_id": "imagegalleryclient",
    "scope": [
      "openid",
      "profile",
      "address",
      "roles",
      "country",
      "subscriptionlevel",
      "imagegalleryapi",
      "offline_access"
    ],
    "sub": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
    "auth_time": 1559311430,
    "idp": "local",
    "amr": "pwd",
    "role": "PayingUser"
  }
}
IdentityServer4.Validation.IntrospectionRequestValidator:Debug: Introspection request validation successful.
IdentityServer4.ResponseHandling.IntrospectionResponseGenerator:Debug: Creating introspection response for active token.
IdentityServer4.Endpoints.IntrospectionEndpoint:Information: Success token introspection. Token active: True, for API name: imagegalleryapi
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 35.7942ms 200 application/json; charset=UTF-8
IdentityModel.AspNetCore.OAuth2Introspection.OAuth2IntrospectionHandler:Debug: AuthenticationScheme: BearerIdentityServerAuthenticationIntrospection was successfully authenticated.
IdentityServer4.AccessTokenValidation.IdentityServerAuthenticationHandler:Debug: AuthenticationScheme: Bearer was successfully authenticated.

QQHQ :: API :: ...EXECUTE API

Microsoft.AspNetCore.Routing.Tree.TreeRouter:Debug: Request successfully matched the route with name '(null)' and template 'api/images'
Microsoft.AspNetCore.Mvc.Internal.ActionSelector:Debug: Action 'ImageGallery.API.Controllers.ImagesController.CreateImage (ImageGallery.API)' with id '763a4689-3a85-4433-a233-a44ca510cb2b' did not match the constraint 'Microsoft.AspNetCore.Mvc.Internal.HttpMethodActionConstraint'
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "GetImages", controller = "Images"}. Executing action ImageGallery.API.Controllers.ImagesController.GetImages (ImageGallery.API)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of authorization filters (in the following order): Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of resource filters (in the following order): Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of action filters (in the following order): Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter (Order: -2147483648), Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of exception filters (in the following order): None
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Debug: Execution plan of result filters (in the following order): Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: Before executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Authorization Filter: After executing OnAuthorizationAsync on filter Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: Before executing OnResourceExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: After executing OnResourceExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecutionAsync on filter Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecuting on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecuting on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method ImageGallery.API.Controllers.ImagesController.GetImages (ImageGallery.API) - Validation state: Valid
Microsoft.EntityFrameworkCore.Infrastructure:Information: Entity Framework Core 2.2.3-servicing-35854 initialized 'GalleryContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opening connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Opened connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Command:Debug: Executing DbCommand [Parameters=[@__ownerId_0='?' (Size = 50)], CommandType='Text', CommandTimeout='30']
SELECT [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
FROM [Images] AS [i]
WHERE [i].[OwnerId] = @__ownerId_0
ORDER BY [i].[Title]
Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (11ms) [Parameters=[@__ownerId_0='?' (Size = 50)], CommandType='Text', CommandTimeout='30']
SELECT [i].[Id], [i].[FileName], [i].[OwnerId], [i].[Title]
FROM [Images] AS [i]
WHERE [i].[OwnerId] = @__ownerId_0
ORDER BY [i].[Title]
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.ChangeTracking:Debug: Context 'GalleryContext' started tracking 'Image' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
Microsoft.EntityFrameworkCore.Database.Command:Debug: A data reader was disposed.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closing connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.EntityFrameworkCore.Database.Connection:Debug: Closed connection to database 'ImageGalleryDB' on server '(localdb)\mssqllocaldb'.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method ImageGallery.API.Controllers.ImagesController.GetImages (ImageGallery.API), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 33.969ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: Before executing OnActionExecuted on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecuted on filter Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Action Filter: After executing OnActionExecutionAsync on filter Microsoft.AspNetCore.Mvc.Internal.ControllerActionFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: Before executing OnResultExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: After executing OnResultExecuting on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Before executing action result Microsoft.AspNetCore.Mvc.OkObjectResult.
Microsoft.AspNetCore.Mvc.Infrastructure.DefaultOutputFormatterSelector:Debug: List of registered output formatters, in the following order: Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter, Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter, Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter, Microsoft.AspNetCore.Mvc.Formatters.JsonOutputFormatter
Microsoft.AspNetCore.Mvc.Infrastructure.DefaultOutputFormatterSelector:Debug: Attempting to select an output formatter based on Accept header 'application/json'.
Microsoft.AspNetCore.Mvc.Infrastructure.DefaultOutputFormatterSelector:Debug: Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.JsonOutputFormatter' and content type 'application/json' to write the response.
Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor:Information: Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[ImageGallery.Model.Image, ImageGallery.Model, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: After executing action result Microsoft.AspNetCore.Mvc.OkObjectResult.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: Before executing OnResultExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Result Filter: After executing OnResultExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: Before executing OnResourceExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Trace: Resource Filter: After executing OnResourceExecuted on filter Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.SaveTempDataFilter.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.API.Controllers.ImagesController.GetImages (ImageGallery.API) in 74.7245ms
Microsoft.AspNetCore.Server.Kestrel:Debug: Connection id "0HLN5Q2LN75G8" completed keep alive response.

QQHQ :: ...RENDERING HOME PAGE

Microsoft.EntityFrameworkCore.Infrastructure:Debug: 'GalleryContext' disposed.
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 144.5263ms 200 application/json; charset=utf-8
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client), returned result Microsoft.AspNetCore.Mvc.ViewResult in 162.6335ms.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executing ViewResult, running view Index.
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executed ViewResult - view Index executed in 6.5114ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client) in 177.7105ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 184.4087ms 200 text/html; charset=utf-8


QQHQ ***********************************************************************************************************************************************
QQHQ :: HOME PAGE SHOWN..7.LOGOUT


Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/Gallery/Logout
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "Logout", controller = "Gallery"}. Executing action ImageGallery.Client.Controllers.GalleryController.Logout (ImageGallery.Client)
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method ImageGallery.Client.Controllers.GalleryController.Logout (ImageGallery.Client) - Validation state: Valid

QQHQ :: ...*GET OIDC DISCOVERY

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/.well-known/openid-configuration
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /.well-known/openid-configuration matched to endpoint type Discovery
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
IdentityServer4.Endpoints.DiscoveryEndpoint:Debug: Start discovery request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 10.0058ms 200 application/json; charset=UTF-8
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/.well-known/openid-configuration/jwks
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
IdentityServer4.Endpoints.DiscoveryKeyEndpoint:Debug: Start key discovery request
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 21.5196ms 200 application/jwk-set+json; charset=UTF-8

QQHQ :: EXTRACT ACCESS TOKEN

QQHQ :: ...*REVOKE ACCESS TOKEN

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST https://localhost:44314/connect/revocation application/x-www-form-urlencoded 162
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/revocation matched to endpoint type Revocation
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Revocation, successfully created handler: IdentityServer4.Endpoints.TokenRevocationEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenRevocationEndpoint for /connect/revocation
IdentityServer4.Endpoints.TokenRevocationEndpoint:Debug: Start revocation request.
IdentityServer4.Validation.ClientSecretValidator:Debug: Start client validation
IdentityServer4.Validation.BasicAuthenticationSecretParser:Debug: Start parsing Basic Authentication secret
IdentityServer4.Validation.PostBodySecretParser:Debug: Start parsing for secret in post body
IdentityServer4.Validation.SecretParser:Debug: Parser found secret: PostBodySecretParser
IdentityServer4.Validation.SecretParser:Debug: Secret id found: imagegalleryclient
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.SecretValidator:Debug: Secret validator success: HashedSharedSecretValidator
IdentityServer4.Validation.ClientSecretValidator:Debug: Client validation success
IdentityServer4.Validation.TokenRevocationRequestValidator:Debug: Token type hint found in request: access_token
IdentityServer4.Validation.TokenRevocationRequestValidator:Debug: ValidateRequestAsync result: IdentityServer4.Validation.TokenRevocationRequestValidationResult
IdentityServer4.ResponseHandling.TokenRevocationResponseGenerator:Debug: Access token revoked
IdentityServer4.Endpoints.TokenRevocationEndpoint:Information: Token successfully revoked
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 53.1316ms 200

QQHQ :: EXTRACT REFRESH TOKEN

QQHQ :: ..*REVOKE REFRESH TOKEN

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 POST https://localhost:44314/connect/revocation application/x-www-form-urlencoded 163
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/revocation matched to endpoint type Revocation
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Revocation, successfully created handler: IdentityServer4.Endpoints.TokenRevocationEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenRevocationEndpoint for /connect/revocation
IdentityServer4.Endpoints.TokenRevocationEndpoint:Debug: Start revocation request.
IdentityServer4.Validation.ClientSecretValidator:Debug: Start client validation
IdentityServer4.Validation.BasicAuthenticationSecretParser:Debug: Start parsing Basic Authentication secret
IdentityServer4.Validation.PostBodySecretParser:Debug: Start parsing for secret in post body
IdentityServer4.Validation.SecretParser:Debug: Parser found secret: PostBodySecretParser
IdentityServer4.Validation.SecretParser:Debug: Secret id found: imagegalleryclient
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.SecretValidator:Debug: Secret validator success: HashedSharedSecretValidator
IdentityServer4.Validation.ClientSecretValidator:Debug: Client validation success
IdentityServer4.Validation.TokenRevocationRequestValidator:Debug: Token type hint found in request: refresh_token
IdentityServer4.Validation.TokenRevocationRequestValidator:Debug: ValidateRequestAsync result: IdentityServer4.Validation.TokenRevocationRequestValidationResult
IdentityServer4.ResponseHandling.TokenRevocationResponseGenerator:Debug: Refresh token revoked
IdentityServer4.Endpoints.TokenRevocationEndpoint:Information: Token successfully revoked
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 41.4314ms 200

QQHQ :: SIGNOUT COOKIES AND OIDC

Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler:Information: AuthenticationScheme: Cookies signed out.
Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler:Information: AuthenticationScheme: oidc signed out.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method ImageGallery.Client.Controllers.GalleryController.Logout (ImageGallery.Client), returned result Microsoft.AspNetCore.Mvc.EmptyResult in 226.095ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.Client.Controllers.GalleryController.Logout (ImageGallery.Client) in 231.4681ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 240.6245ms 302

QQHQ ***********************************************************************************************************************************************
QQHQ :: ...**SIGNOUT OIDC

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/connect/endsession?post_logout_redirect_uri=https%3A%2F%2Flocalhost%3A44393%2Fsignout-callback-oidc&id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IjAzOGRiNTljYmM4ZDAxOWI1MjQ1YzNhODIzYWM5MTg3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1NTkzMTE2NjQsImV4cCI6MTU1OTMxMTk2NCwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NDQzMTQiLCJhdWQiOiJpbWFnZWdhbGxlcnljbGllbnQiLCJpYXQiOjE1NTkzMTE2NjQsImF0X2hhc2giOiJfZHNQeThxY2tiMkFyZ1YwaktpVTNRIiwic3ViIjoiYjc1Mzk2OTQtOTdlNy00ZGZlLTg0ZGEtYjQyNTZlMWZmNWM3IiwiYXV0aF90aW1lIjoxNTU5MzExNDMwLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.oab_73mm1yNvpVnk8RlQoC9xTt2Rhji1fprPzI1jCjqutoHJLG7onewYfpkR6-SalVyynJZeW_fHTx1PEEWKsKDCc4gqelB2cDPgyxm1kFgzrqTNotbCOf7USbotBvbdLWArbWaNGG7NJ5K6SYcA1iaFRV_fPhN6Xau1sO2qwViV1vy9VS7aDwcOex40OTyiXgxYHkFQbvJDHU1uJ2ykcs2Q-8fqvqpLxROYfzU8hpDc1W47SSCuWM83lukN6qMep6Ue3HviqEPTVdwn4bUu-F4CP2NUUtpO0b7sTc7tU5y5VxWj3OCvhAmUNI8Fr_Cydo9mguMN7XokrW7-90lmVw&state=CfDJ8HghKrsNTG1Ijn_2fLmnscvKkpAHCxkFMPafuCyQakHuwqp54Grf2O1E7UUQ3KlR1Nui0Mhr_uop0-eOosOmPF2Qpzm--aG3PzKN6bCn2X2p7XnYkzUBg3NpAcIQp0kVqCK2CZUDMmhd0tuSMrnY0ZWynSsEH_DcTpLLKtXH3tSx&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/endsession matched to endpoint type Endsession
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
IdentityServer4.Endpoints.EndSessionEndpoint:Debug: Processing signout request for b7539694-97e7-4dfe-84da-b4256e1ff5c7
IdentityServer4.Validation.EndSessionRequestValidator:Debug: Start end session request validation
IdentityServer4.Validation.TokenValidator:Debug: Start identity token validation
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.TokenValidator:Debug: Client found: imagegalleryclient / Image Gallery
IdentityServer4.Test.TestUserProfileService:Debug: IsActive called from: IdentityTokenValidation
IdentityServer4.Validation.TokenValidator:Debug: Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
IdentityServer4.Validation.TokenValidator:Debug: Token validation success
{
  "ClientId": "imagegalleryclient",
  "ClientName": "Image Gallery",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1559311664,
    "exp": 1559311964,
    "iss": "https://localhost:44314",
    "aud": "imagegalleryclient",
    "iat": 1559311664,
    "at_hash": "_dsPy8qckb2ArgV0jKiU3Q",
    "sub": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
    "auth_time": 1559311430,
    "idp": "local",
    "amr": "pwd"
  }
}
IdentityServer4.Validation.EndSessionRequestValidator:Information: End session request validation success
{
  "ClientId": "imagegalleryclient",
  "ClientName": "Image Gallery",
  "SubjectId": "b7539694-97e7-4dfe-84da-b4256e1ff5c7",
  "PostLogOutUri": "https://localhost:44393/signout-callback-oidc",
  "State": "CfDJ8HghKrsNTG1Ijn_2fLmnscvKkpAHCxkFMPafuCyQakHuwqp54Grf2O1E7UUQ3KlR1Nui0Mhr_uop0-eOosOmPF2Qpzm--aG3PzKN6bCn2X2p7XnYkzUBg3NpAcIQp0kVqCK2CZUDMmhd0tuSMrnY0ZWynSsEH_DcTpLLKtXH3tSx",
  "Raw": {
    "post_logout_redirect_uri": "https://localhost:44393/signout-callback-oidc",
    "id_token_hint": "***REDACTED***",
    "state": "CfDJ8HghKrsNTG1Ijn_2fLmnscvKkpAHCxkFMPafuCyQakHuwqp54Grf2O1E7UUQ3KlR1Nui0Mhr_uop0-eOosOmPF2Qpzm--aG3PzKN6bCn2X2p7XnYkzUBg3NpAcIQp0kVqCK2CZUDMmhd0tuSMrnY0ZWynSsEH_DcTpLLKtXH3tSx",
    "x-client-SKU": "ID_NETSTANDARD2_0",
    "x-client-ver": "5.3.0.0"
  }
}
IdentityServer4.Endpoints.EndSessionEndpoint:Debug: Success validating end session request from imagegalleryclient
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 83.6758ms 302

QQHQ :: OIDC :: ...*LOGOUT OIDC

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/Account/Logout?logoutId=CfDJ8HghKrsNTG1Ijn_2fLmnscvQTbTzn1rEbyMJRk-Zp4zcE29O0bk_tpLMl0M1F2AvyNYdC-Xsfj3hksgBmBUX3W0QdtdSlUUfb1mb1TRzjVmd2i8gAXeYGS7srpFjUDYooKSKA2gZuW0kRpEEmamBlpskohSn_qS03yJ24HEn9Jjyjiv5GnNTRvzlB824JpxvxJ9AoM46K0u3e6hZ4zdLAANO3V5oMSHnKChjzXiDrpIIxNQ8C1Ec13D-sq_R_hGdRo43rAAhFWwgSfsmRbbmDDwr2yHrXsJZ_9xP2gIEVBKgpLqIwAEwbZCZGovGtp9T93-OyWMU53urY-X4CE2-tcWU8gslcuIhlOiCI20o1nyuBjr4Cj7PcjaNLHKEMICleWwmqtuEDzHX6GlyUvIdDxrDTjzCo-Rgf0_2S5Qlp6-ly6Z528locLT77XAQV7pOzAyJjR-uOO9YqCJwVkQMHGWicjm5Vwj-nKS8Oh1tMKLaZY4Snv1mNz2DztBskpwEQZ23mS695y-6TN0_j63MiwsEEFMvZQTE_NdWwQkk1e78Hm1x5mZjSSnAHZDpoIb6tHe6pw1q4WSKV3BGW2JODNfcrH5YROs0XjbKq_WRN44s9wWjSOFg0EN95TDklgTQW-aNfKURR6CIO16OEFnYVFphXYc9V07wzEOArEmPi57LIkRya1GaWhFnxHkaX2hBZRYQ-_so0Xj_FFRmJCIdmRWbfZFxo27hYenkz_ERwdO8iBVImxTO3tZjMj-E4jJcM8I6KTnU6DCAiqWWL3njSCGdFzhmY-IYURpoLJ7o14eoNi3ek6NEKQvkWyKxkhbyztThRizMZXclFX-Xv2cR3X3YSUBZzKoEV3kFf5xIozd5o-zixnrJBdOqF0DLJm1vIqHJndrYWlEJqiNT6oKV2JU
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "Logout", controller = "Account"}. Executing action IdentityServer4.Quickstart.UI.AccountController.Logout (Marvin.IDP)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method IdentityServer4.Quickstart.UI.AccountController.Logout (Marvin.IDP) with arguments (CfDJ8HghKrsNTG1Ijn_2fLmnscvQTbTzn1rEbyMJRk-Zp4zcE29O0bk_tpLMl0M1F2AvyNYdC-Xsfj3hksgBmBUX3W0QdtdSlUUfb1mb1TRzjVmd2i8gAXeYGS7srpFjUDYooKSKA2gZuW0kRpEEmamBlpskohSn_qS03yJ24HEn9Jjyjiv5GnNTRvzlB824JpxvxJ9AoM46K0u3e6hZ4zdLAANO3V5oMSHnKChjzXiDrpIIxNQ8C1Ec13D-sq_R_hGdRo43rAAhFWwgSfsmRbbmDDwr2yHrXsJZ_9xP2gIEVBKgpLqIwAEwbZCZGovGtp9T93-OyWMU53urY-X4CE2-tcWU8gslcuIhlOiCI20o1nyuBjr4Cj7PcjaNLHKEMICleWwmqtuEDzHX6GlyUvIdDxrDTjzCo-Rgf0_2S5Qlp6-ly6Z528locLT77XAQV7pOzAyJjR-uOO9YqCJwVkQMHGWicjm5Vwj-nKS8Oh1tMKLaZY4Snv1mNz2DztBskpwEQZ23mS695y-6TN0_j63MiwsEEFMvZQTE_NdWwQkk1e78Hm1x5mZjSSnAHZDpoIb6tHe6pw1q4WSKV3BGW2JODNfcrH5YROs0XjbKq_WRN44s9wWjSOFg0EN95TDklgTQW-aNfKURR6CIO16OEFnYVFphXYc9V07wzEOArEmPi57LIkRya1GaWhFnxHkaX2hBZRYQ-_so0Xj_FFRmJCIdmRWbfZFxo27hYenkz_ERwdO8iBVImxTO3tZjMj-E4jJcM8I6KTnU6DCAiqWWL3njSCGdFzhmY-IYURpoLJ7o14eoNi3ek6NEKQvkWyKxkhbyztThRizMZXclFX-Xv2cR3X3YSUBZzKoEV3kFf5xIozd5o-zixnrJBdOqF0DLJm1vIqHJndrYWlEJqiNT6oKV2JU) - Validation state: Valid
Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler:Information: AuthenticationScheme: idsrv signed out.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method IdentityServer4.Quickstart.UI.AccountController.Logout (Marvin.IDP), returned result Microsoft.AspNetCore.Mvc.ViewResult in 25.5185ms.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executing ViewResult, running view LoggedOut.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executed ViewResult - view LoggedOut executed in 35.6317ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action IdentityServer4.Quickstart.UI.AccountController.Logout (Marvin.IDP) in 92.598ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 104.676ms 200 text/html; charset=utf-8

QQHQ :: OIDC :: ...*ENDSESSION

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/connect/endsession/callback?endSessionId=CfDJ8HghKrsNTG1Ijn_2fLmnsctvrSl9IAJB_KqfFjdEHK8_W_jreH1eySYUhQYftjuyNUMmrb6JEXSTC_f31SLDdZFiKnOIpiVE79WUo5b3XgHNXwkqjYAwU9Nm92GFWd8QUrW29-KdKFkR5GoI8-UzT0Lfk2e53ikV_rVtw8mIwqYqZB5lEjBxVw-vjqtPXufpVA8mAae7kxT0ZTNQ51ITXL8oXcykS3zHcal8Z7XJr9KKuKiz9ICSryc4y8AMD4yNqvxE3mmqVRh_qiWDQ-ACBsj5RmQZYJVStZpReEY_UDgxOYQPJXs1V2vgdLqsWjCssIA7YVUg6UIwjYwR2JgebXw
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/endsession/callback matched to endpoint type Endsession
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
IdentityServer4.Endpoints.EndSessionCallbackEndpoint:Debug: Processing signout callback request
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.EndSessionRequestValidator:Debug: No client front-channel logout URLs
IdentityServer4.Validation.EndSessionRequestValidator:Debug: No client back-channel logout URLs
IdentityServer4.Endpoints.EndSessionCallbackEndpoint:Information: Successful signout callback.
IdentityServer4.Endpoints.EndSessionCallbackEndpoint:Debug: No client front-channel iframe urls
IdentityServer4.Endpoints.EndSessionCallbackEndpoint:Debug: No client back-channel iframe urls
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 109.6052ms 200 text/html; charset=UTF-8

QQHQ :: OIDC :: ...*CALL BACK TO CLIENT SIGNOUT

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/signout-callback-oidc?state=CfDJ8HghKrsNTG1Ijn_2fLmnscvKkpAHCxkFMPafuCyQakHuwqp54Grf2O1E7UUQ3KlR1Nui0Mhr_uop0-eOosOmPF2Qpzm--aG3PzKN6bCn2X2p7XnYkzUBg3NpAcIQp0kVqCK2CZUDMmhd0tuSMrnY0ZWynSsEH_DcTpLLKtXH3tSx
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 3.8034ms 302

QQHQ ***********************************************************************************************************************************************
QQHQ :: ...*REDIRECT TO HOME :: http://localhost:44393/

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44393/
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "Index", controller = "Gallery"}. Executing action ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client)
Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization failed.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Authorization failed for the request at filter 'Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter'.
Microsoft.AspNetCore.Mvc.ChallengeResult:Information: Executing ChallengeResult with authentication schemes ().
Microsoft.AspNetCore.Authentication.OpenIdConnect.OpenIdConnectHandler:Information: AuthenticationScheme: oidc was challenged.

QQHQ :: ...**EXECUTE OIDC CHALLENGE

Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action ImageGallery.Client.Controllers.GalleryController.Index (ImageGallery.Client) in 10.7639ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 17.3751ms 302

QQHQ :: ...**REDIRECT TO OIDC AUTHORIZATION ENDPOINT

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/connect/authorize?client_id=imagegalleryclient&redirect_uri=https%3A%2F%2Flocalhost%3A44393%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20address%20roles%20country%20subscriptionlevel%20imagegalleryapi%20offline_access&response_mode=form_post&nonce=636949084935914553.NWJkODBhMGUtYTgxOC00NmZhLTk5ZGUtMmNkNjYwMGRmYWQ2M2E0ZWNiMjQtYzZmNC00NDdmLTkwYmUtZmM3MjQwOGQzZjkz&state=CfDJ8HghKrsNTG1Ijn_2fLmnscuaqj8xv-EuT0BZs7GBtSWa_iRonmkKrY9T00FPTzEygkosSegxIIpRutwtwTJoHRrVwaGmN6ZdCPddc5VdTgoPV3iCegKfkajaxy6cem6TC0Ie6wzY8tQeoJm1gZOJk6L9YSxen1PgqFjn4YZVQyfzXZu7YM-uhS-XRWYkrLEO8O7snoqLxpLyOiBtwg6Ew6LmJY-dWUO4ZLiUhZyaD5VVldufbfeS3fmWO6N5F1FfKpfh6T9TjUqfvyy1MqJBSn4KE2jvW2kJtPw7eCqorjh3P3Vl_SbF91zeJDQQLRSLU9H8UZwrWWoF9Q3bnEAQvo0&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0
IdentityServer4.Hosting.EndpointRouter:Debug: Request path /connect/authorize matched to endpoint type Authorize
IdentityServer4.Hosting.EndpointRouter:Debug: Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
IdentityServer4.Hosting.IdentityServerMiddleware:Information: Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
IdentityServer4.Endpoints.AuthorizeEndpoint:Debug: Start authorize request
IdentityServer4.Endpoints.AuthorizeEndpoint:Debug: No user present in authorize request
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Start authorize request protocol validation
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Checking for PKCE parameters
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: No PKCE used.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
IdentityServer4.Endpoints.AuthorizeEndpoint:Information: ValidatedAuthorizeRequest
{
  "ClientId": "imagegalleryclient",
  "ClientName": "Image Gallery",
  "RedirectUri": "https://localhost:44393/signin-oidc",
  "AllowedRedirectUris": [
    "https://localhost:44393/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile address roles country subscriptionlevel imagegalleryapi offline_access",
  "State": "CfDJ8HghKrsNTG1Ijn_2fLmnscuaqj8xv-EuT0BZs7GBtSWa_iRonmkKrY9T00FPTzEygkosSegxIIpRutwtwTJoHRrVwaGmN6ZdCPddc5VdTgoPV3iCegKfkajaxy6cem6TC0Ie6wzY8tQeoJm1gZOJk6L9YSxen1PgqFjn4YZVQyfzXZu7YM-uhS-XRWYkrLEO8O7snoqLxpLyOiBtwg6Ew6LmJY-dWUO4ZLiUhZyaD5VVldufbfeS3fmWO6N5F1FfKpfh6T9TjUqfvyy1MqJBSn4KE2jvW2kJtPw7eCqorjh3P3Vl_SbF91zeJDQQLRSLU9H8UZwrWWoF9Q3bnEAQvo0",
  "Nonce": "636949084935914553.NWJkODBhMGUtYTgxOC00NmZhLTk5ZGUtMmNkNjYwMGRmYWQ2M2E0ZWNiMjQtYzZmNC00NDdmLTkwYmUtZmM3MjQwOGQzZjkz",
  "Raw": {
    "client_id": "imagegalleryclient",
    "redirect_uri": "https://localhost:44393/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile address roles country subscriptionlevel imagegalleryapi offline_access",
    "response_mode": "form_post",
    "nonce": "636949084935914553.NWJkODBhMGUtYTgxOC00NmZhLTk5ZGUtMmNkNjYwMGRmYWQ2M2E0ZWNiMjQtYzZmNC00NDdmLTkwYmUtZmM3MjQwOGQzZjkz",
    "state": "CfDJ8HghKrsNTG1Ijn_2fLmnscuaqj8xv-EuT0BZs7GBtSWa_iRonmkKrY9T00FPTzEygkosSegxIIpRutwtwTJoHRrVwaGmN6ZdCPddc5VdTgoPV3iCegKfkajaxy6cem6TC0Ie6wzY8tQeoJm1gZOJk6L9YSxen1PgqFjn4YZVQyfzXZu7YM-uhS-XRWYkrLEO8O7snoqLxpLyOiBtwg6Ew6LmJY-dWUO4ZLiUhZyaD5VVldufbfeS3fmWO6N5F1FfKpfh6T9TjUqfvyy1MqJBSn4KE2jvW2kJtPw7eCqorjh3P3Vl_SbF91zeJDQQLRSLU9H8UZwrWWoF9Q3bnEAQvo0",
    "x-client-SKU": "ID_NETSTANDARD2_0",
    "x-client-ver": "5.3.0.0"
  }
}
IdentityServer4.ResponseHandling.AuthorizeInteractionResponseGenerator:Information: Showing login: User is not authenticated
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 32.5206ms 302

QQHQ :: OIDC :: ...*REQUEST LOGIN PAGE

Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET https://localhost:44314/Account/Login?ReturnUrl=%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3Dimagegalleryclient%26redirect_uri%3Dhttps%253A%252F%252Flocalhost%253A44393%252Fsignin-oidc%26response_type%3Dcode%2520id_token%26scope%3Dopenid%2520profile%2520address%2520roles%2520country%2520subscriptionlevel%2520imagegalleryapi%2520offline_access%26response_mode%3Dform_post%26nonce%3D636949084935914553.NWJkODBhMGUtYTgxOC00NmZhLTk5ZGUtMmNkNjYwMGRmYWQ2M2E0ZWNiMjQtYzZmNC00NDdmLTkwYmUtZmM3MjQwOGQzZjkz%26state%3DCfDJ8HghKrsNTG1Ijn_2fLmnscuaqj8xv-EuT0BZs7GBtSWa_iRonmkKrY9T00FPTzEygkosSegxIIpRutwtwTJoHRrVwaGmN6ZdCPddc5VdTgoPV3iCegKfkajaxy6cem6TC0Ie6wzY8tQeoJm1gZOJk6L9YSxen1PgqFjn4YZVQyfzXZu7YM-uhS-XRWYkrLEO8O7snoqLxpLyOiBtwg6Ew6LmJY-dWUO4ZLiUhZyaD5VVldufbfeS3fmWO6N5F1FfKpfh6T9TjUqfvyy1MqJBSn4KE2jvW2kJtPw7eCqorjh3P3Vl_SbF91zeJDQQLRSLU9H8UZwrWWoF9Q3bnEAQvo0%26x-client-SKU%3DID_NETSTANDARD2_0%26x-client-ver%3D5.3.0.0
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Route matched with {action = "Login", controller = "Account"}. Executing action IdentityServer4.Quickstart.UI.AccountController.Login (Marvin.IDP)
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executing action method IdentityServer4.Quickstart.UI.AccountController.Login (Marvin.IDP) with arguments (/connect/authorize/callback?client_id=imagegalleryclient&redirect_uri=https%3A%2F%2Flocalhost%3A44393%2Fsignin-oidc&response_type=code%20id_token&scope=openid%20profile%20address%20roles%20country%20subscriptionlevel%20imagegalleryapi%20offline_access&response_mode=form_post&nonce=636949084935914553.NWJkODBhMGUtYTgxOC00NmZhLTk5ZGUtMmNkNjYwMGRmYWQ2M2E0ZWNiMjQtYzZmNC00NDdmLTkwYmUtZmM3MjQwOGQzZjkz&state=CfDJ8HghKrsNTG1Ijn_2fLmnscuaqj8xv-EuT0BZs7GBtSWa_iRonmkKrY9T00FPTzEygkosSegxIIpRutwtwTJoHRrVwaGmN6ZdCPddc5VdTgoPV3iCegKfkajaxy6cem6TC0Ie6wzY8tQeoJm1gZOJk6L9YSxen1PgqFjn4YZVQyfzXZu7YM-uhS-XRWYkrLEO8O7snoqLxpLyOiBtwg6Ew6LmJY-dWUO4ZLiUhZyaD5VVldufbfeS3fmWO6N5F1FfKpfh6T9TjUqfvyy1MqJBSn4KE2jvW2kJtPw7eCqorjh3P3Vl_SbF91zeJDQQLRSLU9H8UZwrWWoF9Q3bnEAQvo0&x-client-SKU=ID_NETSTANDARD2_0&x-client-ver=5.3.0.0) - Validation state: Valid
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Start authorize request protocol validation
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Checking for PKCE parameters
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: No PKCE used.
IdentityServer4.Validation.AuthorizeRequestValidator:Debug: Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
IdentityServer4.Stores.ValidatingClientStore:Debug: client configuration validation for client imagegalleryclient succeeded.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action method IdentityServer4.Quickstart.UI.AccountController.Login (Marvin.IDP), returned result Microsoft.AspNetCore.Mvc.ViewResult in 15.6147ms.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executing ViewResult, running view Login.
Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor:Information: Executed ViewResult - view Login executed in 4.3595ms.
Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker:Information: Executed action IdentityServer4.Quickstart.UI.AccountController.Login (Marvin.IDP) in 51.5692ms
Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 59.4618ms 200 text/html; charset=utf-8

QQHQ :: LOGIN PAGE SHOWN





